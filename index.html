<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>10th Annual Silvalympics</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Arial, sans-serif; background: linear-gradient(135deg, #1e40af 0%, #1e3a8a 100%); min-height: 100vh; padding-bottom: 80px; }
        .container { max-width: 800px; margin: 0 auto; padding: 20px; }
        .title { color: white; text-align: center; font-size: 32px; font-weight: bold; margin-bottom: 30px; }
        .team-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; margin-bottom: 20px; }
        @media (min-width: 768px) { .team-grid { grid-template-columns: repeat(4, 1fr); } }
        .team-btn { background: white; padding: 20px; border-radius: 10px; border: none; cursor: pointer; box-shadow: 0 4px 6px rgba(0,0,0,0.1); transition: transform 0.2s; }
        .team-btn:hover { transform: scale(1.05); box-shadow: 0 6px 12px rgba(0,0,0,0.15); }
        .team-num { color: #667eea; font-weight: bold; font-size: 18px; margin-bottom: 5px; }
        .team-name { color: #666; font-size: 14px; }
        .card { background: white; border-radius: 15px; padding: 25px; box-shadow: 0 8px 16px rgba(0,0,0,0.1); }
        .back-btn { color: white; background: none; border: none; cursor: pointer; margin-bottom: 15px; font-size: 16px; }
        .back-btn:hover { text-decoration: underline; }
        .card-title { color: #667eea; font-size: 24px; font-weight: bold; text-align: center; margin-bottom: 25px; }
        .menu-btn { width: 100%; padding: 15px; margin-bottom: 12px; border: none; border-radius: 8px; font-size: 16px; font-weight: 600; cursor: pointer; color: white; transition: opacity 0.2s; }
        .menu-btn:hover { opacity: 0.9; }
        .blue { background: #3b82f6; }
        .green { background: #10b981; }
        .purple { background: #8b5cf6; }
        .orange { background: #f59e0b; }
        .red { background: #ef4444; }
        .input-group { margin-bottom: 20px; }
        .input-group label { display: block; font-weight: 600; margin-bottom: 5px; color: #333; }
        .input-group input { width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px; font-size: 16px; }
        .wager-row { display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px; }
        .wager-row label { flex: 1; font-size: 16px; font-weight: bold; }
        .wager-row input { width: 80px; padding: 8px; text-align: center; border: 1px solid #ddd; border-radius: 6px; }
        .total { font-size: 18px; font-weight: bold; margin: 20px 0; }
        .total.valid { color: #10b981; }
        .total.invalid { color: #ef4444; }
        .schedule-item { border: 1px solid #e5e7eb; border-radius: 8px; padding: 15px; margin-bottom: 12px; background: #f9fafb; }
        .schedule-time { font-weight: bold; font-size: 18px; margin-bottom: 5px; }
        .schedule-event { color: #8b5cf6; font-weight: 600; margin-bottom: 3px; }
        .schedule-vs { color: #666; font-size: 14px; }
        .result-btns { display: flex; gap: 10px; margin-top: 10px; }
        .result-btns button { flex: 1; padding: 10px; border: none; border-radius: 6px; font-weight: 600; cursor: pointer; }
        .win-btn { background: #d1fae5; color: #065f46; }
        .win-btn.active { background: #10b981; color: white; }
        .lose-btn { background: #fee2e2; color: #991b1b; }
        .lose-btn.active { background: #ef4444; color: white; }
        .standing { display: flex; align-items: center; justify-content: space-between; padding: 12px; border-radius: 8px; margin-bottom: 8px; }
        .standing-green { background: #d1fae5; }
        .standing-blue { background: #dbeafe; }
        .standing-red { background: #fee2e2; }
        .standing-left { display: flex; align-items: center; gap: 15px; flex: 1; }
        .standing-rank { font-size: 24px; font-weight: bold; color: #999; width: 30px; }
        .standing-name { font-weight: 600; color: #333; }
        .standing-record { color: #666; font-size: 14px; }
        .standing-badge { font-size: 12px; font-weight: bold; }
        .badge-green { color: #065f46; }
        .badge-blue { color: #1e40af; }
        .scrollable { max-height: 500px; overflow-y: auto; }
        .info-box { background: #f3f4f6; border-radius: 8px; padding: 15px; margin-top: 20px; font-size: 14px; }
        .info-box div { margin-bottom: 5px; color: #666; }
        .saved { background: #10b981 !important; }
        .hide { display: none; }
        .status { position: fixed; top: 10px; right: 10px; padding: 8px 12px; border-radius: 20px; font-size: 12px; font-weight: bold; z-index: 1000; }
        .status-connected { background: #10b981; color: white; }
        .status-error { background: #ef4444; color: white; }
        .status-loading { background: #f59e0b; color: white; }
        .button-container { display: flex; gap: 10px; justify-content: center; margin-top: 20px; flex-wrap: wrap; }
        .clear-data-btn { padding: 8px 12px; background: #ef4444; color: white; border: none; border-radius: 6px; font-size: 12px; cursor: pointer; }
        .clear-data-btn:hover { background: #dc2626; }
        .toggle-schedule-btn { padding: 8px 12px; background: #f59e0b; color: white; border: none; border-radius: 6px; font-size: 12px; cursor: pointer; }
        .toggle-schedule-btn:hover { background: #ea580c; }
        .disabled { opacity: 0.5; cursor: not-allowed !important; background: #9ca3af !important; }
    </style>
</head>
<body>
    <div class="container" id="app"></div>

    <script>
        const EVENTS = ['Mölkky', 'Bocce', 'Giant Pong', 'Cornhole', 'BULZiBUCKET', 'Ladder Ball', 'QB54', 'Soccer Bocce', 'Bean Bag Memory Match'];
        
        const SCHEDULE = [
            { time: '10:40am', matches: [
                [1,2,'Giant Pong'],[3,4,'BULZiBUCKET'],[5,6,'Mölkky'],[7,8,'Cornhole'],[9,10,'Bocce'],
                [11,12,'Ladder Ball'],[13,14,'QB54'],[19,16,'Soccer Bocce'],[17,20,'Bean Bag Memory Match'],[15,18,'Break']
            ]},
            { time: '11:00am', matches: [
                [4,5,'Giant Pong'],[6,7,'BULZiBUCKET'],[8,9,'Mölkky'],[10,11,'Cornhole'],[12,13,'Bocce'],
                [14,3,'Ladder Ball'],[16,17,'QB54'],[18,15,'Soccer Bocce'],[1,19,'Bean Bag Memory Match'],[20,2,'Break']
            ]},
            { time: '11:20am', matches: [
                [6,8,'Giant Pong'],[10,12,'BULZiBUCKET'],[14,16,'Mölkky'],[18,20,'Cornhole'],[2,4,'Bocce'],
                [5,7,'Ladder Ball'],[9,11,'QB54'],[1,17,'Soccer Bocce'],[3,15,'Bean Bag Memory Match'],[13,19,'Break']
            ]},
            { time: '11:40am', matches: [
                [7,9,'Giant Pong'],[11,13,'BULZiBUCKET'],[15,17,'Mölkky'],[19,1,'Cornhole'],[3,5,'Bocce'],
                [4,6,'Ladder Ball'],[8,10,'QB54'],[20,12,'Soccer Bocce'],[2,18,'Bean Bag Memory Match'],[16,14,'Break']
            ]},
            { time: '12:00pm', matches: [
                [10,14,'Giant Pong'],[18,2,'BULZiBUCKET'],[7,11,'Mölkky'],[15,3,'Cornhole'],[19,8,'Bocce'],
                [16,20,'Ladder Ball'],[5,12,'QB54'],[4,6,'Soccer Bocce'],[9,13,'Bean Bag Memory Match'],[17,1,'Break']
            ]},
            { time: '12:20pm', matches: [[0,0,'Pizza!']] },
            { time: '12:40pm', matches: [
                [11,15,'Giant Pong'],[19,9,'BULZiBUCKET'],[3,12,'Mölkky'],[4,16,'Cornhole'],[20,17,'Bocce'],
                [8,13,'Ladder Ball'],[1,18,'QB54'],[10,2,'Soccer Bocce'],[14,7,'Bean Bag Memory Match'],[6,5,'Break']
            ]},
            { time: '1:00pm', matches: [
                [20,19,'Giant Pong'],[15,16,'BULZiBUCKET'],[4,10,'Mölkky'],[2,17,'Cornhole'],[18,6,'Bocce'],
                [1,9,'Ladder Ball'],[7,3,'QB54'],[14,13,'Soccer Bocce'],[11,5,'Bean Bag Memory Match'],[8,12,'Break']
            ]},
            { time: '1:20pm', matches: [
                [18,3,'Giant Pong'],[14,20,'BULZiBUCKET'],[2,13,'Mölkky'],[9,12,'Cornhole'],[1,16,'Bocce'],
                [19,17,'Ladder Ball'],[6,15,'QB54'],[7,5,'Soccer Bocce'],[4,8,'Bean Bag Memory Match'],[11,10,'Break']
            ]},
            { time: '1:40pm', matches: [
                [13,16,'Giant Pong'],[17,5,'BULZiBUCKET'],[1,20,'Mölkky'],[6,14,'Cornhole'],[11,7,'Bocce'],
                [18,15,'Ladder Ball'],[19,2,'QB54'],[9,8,'Soccer Bocce'],[12,10,'Bean Bag Memory Match'],[4,3,'Break']
            ]},
            { time: '2:00pm', matches: [
                [12,17,'Giant Pong'],[8,1,'BULZiBUCKET'],[19,18,'Mölkky'],[5,13,'Cornhole'],[15,14,'Bocce'],
                [2,10,'Ladder Ball'],[4,20,'QB54'],[11,3,'Soccer Bocce'],[16,6,'Bean Bag Memory Match'],[9,7,'Break']
            ]}
        ];

        // REPLACE THIS URL WITH YOUR GOOGLE APPS SCRIPT WEB APP URL
        const BACKEND_URL = 'YOUR_SCRIPT_URL_HERE';
        
        let state = { view: 'team-select', selectedTeam: null, wagersSaved: false, connectionStatus: 'loading' };
        let data = { teamNames: {}, wagers: {}, results: {}, disabledSchedules: {}, disabledWagers: {} };
        let lastUserAction = Date.now();
        let isSaving = false;
        let lastSaveTime = 0;
        let schedulesEnabled = true;
        let wagersEnabled = true;
        
        const EVENT_RULES = {
            'Mölkky': `<div style="padding: 0 20px;">
<h3 style="font-weight: bold; margin-bottom: 10px; margin-top: 20px;">General</h3>
<ul style="list-style-type: disc; list-style-position: outside; padding-left: 40px; margin-bottom: 15px;">
<li style="margin-bottom: 8px;">One game, winner take all.</li>
<li style="margin-bottom: 8px;">Game consists of twelve skittles (i.e. pins) numbered from 1 to 12 and one Mölkky throwing skittle.</li>
<li style="margin-bottom: 8px;">Game is 2-on-2.</li>
<li style="margin-bottom: 8px;">Object is to get exactly 50 points.</li>
<li style="margin-bottom: 8px;">The Mölkky throwing skittle may be thrown any way, for example underhand, overhand, or sideways. It may also bounce on the grass.</li>
</ul>

<h3 style="font-weight: bold; margin-bottom: 10px; margin-top: 20px;">Order of Play</h3>
<ul style="list-style-type: disc; list-style-position: outside; padding-left: 40px; margin-bottom: 15px;">
<li style="margin-bottom: 8px;">The game begins with rocks paper scissors shoot (first to win one).</li>
<li style="margin-bottom: 8px;">One of the teammates from the team that wins starts the game by tossing the Mölkky throwing skittle.</li>
<li style="margin-bottom: 8px;">One of the teammates from the other team then tosses the Mölkky throwing skittle.</li>
<li style="margin-bottom: 8px;">Teams and teammates continue rotating tosses for the rest of the game.</li>
</ul>

<h3 style="font-weight: bold; margin-bottom: 10px; margin-top: 20px;">Setup</h3>
<ul>
<li>At the beginning of the game, the skittles are placed in this formation:</li>
</ul>

<div style="text-align: center; margin: 20px 0;">
<img src="data:image/png;base64,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" alt="Mölkky Setup" style="max-width: 200px; height: auto; border: 1px solid #ddd; border-radius: 8px;">
</div>

<ul style="list-style-type: disc; list-style-position: outside; padding-left: 40px; margin-bottom: 15px;">
<li style="margin-bottom: 8px;">After a throw, fallen skittles are put upright <u>at the place where they fell</u>. As a result, the skittles are naturally spread out as the game progresses.</li>
<li style="margin-bottom: 8px;">The throwing line is 10 feet from the front of the skittle formation. The Mölkky throwing skittle may be thrown from anywhere behind the throwing line, including from either side.</li>
</ul>

<h3 style="font-weight: bold; margin-bottom: 10px; margin-top: 20px;">Scoring</h3>
<ul style="list-style-type: disc; list-style-position: outside; padding-left: 40px; margin-bottom: 15px;">
<li style="margin-bottom: 8px;">If one skittle falls, the score is equal to the number on the pin. When more than one skittle falls, the score is equal to the number of fallen skittles.</li>
<li style="margin-bottom: 8px;">A skittle is not considered fallen if it is leaning on another skittle or on the Mölkky throwing skittle.</li>
<li style="margin-bottom: 8px;">The game ends when the first team reaches exactly 50 points.</li>
<li style="margin-bottom: 8px;">If the team scores over 50, that team's score is lowered to 25.</li>
<li style="margin-bottom: 8px;">If a team misses (has no score) three times in a row, that team's score is lowered to 0.</li>
</ul>

<p style="margin-top: 15px;"><strong>20-Minute Rule:</strong> If time expires and neither team has reached exactly 50 points, then the first team that exceeded 50 points wins. If neither team has exceeded 50 points, then whichever team has the most points wins.</p>

<p style="margin-top: 15px;"><em>Please reset the Molkky skittles after you complete your game so the next teams can play.</em></p>
</div>`,

            'Bocce': `<div style="padding: 0 20px;">
<h3 style="font-weight: bold; margin-bottom: 10px; margin-top: 20px;">General</h3>
<ul style="list-style-type: disc; list-style-position: outside; padding-left: 40px; margin-bottom: 15px;">
<li style="margin-bottom: 8px;">One game, winner take all.</li>
<li style="margin-bottom: 8px;">First team to 7 points wins the game.</li>
<li style="margin-bottom: 8px;">Bocce is played with eight large balls and one smaller target ball called a pallina.</li>
<li style="margin-bottom: 8px;">There are four balls per team and they are made of a different color to distinguish the balls of one team from those of the other team.</li>
<li style="margin-bottom: 8px;">Each player throws two balls.</li>
</ul>

<h3 style="font-weight: bold; margin-bottom: 10px; margin-top: 20px;">Order of Play</h3>
<ul style="list-style-type: disc; list-style-position: outside; padding-left: 40px; margin-bottom: 15px;">
<li style="margin-bottom: 8px;">The game begins with rocks paper scissors shoot (first to win one). The team that wins can choose to either have the first toss of the pallina or the color of the balls they will use.</li>
<li style="margin-bottom: 8px;">To start the game, the pallina is rolled or tossed roughly 20 to 40 feet (~10 to 20 steps). A marker is dropped where the pallina was tossed from. If the distance between the marker and pallina is significantly less than 20 feet or more than 40 feet, the pallina should be picked up and manually moved to an acceptable distance.</li>
<li style="margin-bottom: 8px;">The player tossing the pallina must deliver the first Bocce ball. All balls are tossed from the marker.</li>
<li style="margin-bottom: 8px;">The opposing team then delivers their balls until one of its Bocce balls is closer to the pallina or has thrown all of its balls.</li>
<li style="margin-bottom: 8px;">The "nearest ball" rule governs the sequence of thrown balls.
  <ul style="list-style-type: circle; list-style-position: outside; padding-left: 40px; margin-top: 8px;">
    <li style="margin-bottom: 8px;">The side whose ball is closest to the pallina is called the "in" ball and the opposing side the "out" ball.</li>
    <li style="margin-bottom: 8px;">Whenever a team gets "in", it steps aside and allows the "out" team to deliver.</li>
    <li style="margin-bottom: 8px;">The other team throws until it gets its ball closer to the pallina.</li>
    <li style="margin-bottom: 8px;">This continues until both teams have thrown all their Bocce balls.</li>
  </ul>
</li>
<li style="margin-bottom: 8px;">After both teams have exhausted all their balls, a frame is over and points are awarded.</li>
<li style="margin-bottom: 8px;">The team that was awarded points in the previous frame begins the next frame by tossing the pallina into play.</li>
</ul>

<h3 style="font-weight: bold; margin-bottom: 10px; margin-top: 20px;">Scoring</h3>
<ul style="list-style-type: disc; list-style-position: outside; padding-left: 40px; margin-bottom: 15px;">
<li style="margin-bottom: 8px;">At the end of each frame, points will be awarded.</li>
<li style="margin-bottom: 8px;">Only one team scores in a frame. A team scores between 1 and 4 points per frame.</li>
<li style="margin-bottom: 8px;">One point is awarded for each ball that is closer to the pallina than the closest ball of the opposing team.</li>
<li style="margin-bottom: 8px;">In the event that the closest ball of each team is the same distance from the pallina, no points will be awarded and the pallina returns to the team that delivered it.</li>
<li style="margin-bottom: 8px;">Only balls which are distinguishably closer to the pallina than any of the opponent's balls are awarded points.</li>
<li style="margin-bottom: 8px;">All measurements should be made from the center of the pallina to the edge of a Bocce ball.</li>
<li style="margin-bottom: 8px;">If a Bocce ball is touching the pallina, an extra point is awarded.</li>
</ul>

<p style="margin-top: 15px;"><strong>20-Minute Rule:</strong> If the allotted time expires, the team with the highest point total wins.</p>

<p style="margin-top: 15px;"><em>Please put the balls and pallina next to each other after you complete your game so the next teams can play.</em></p>
</div>`,

            'Giant Pong': `<div style="padding: 0 20px;">
<h3 style="font-weight: bold; margin-bottom: 10px; margin-top: 20px;">General</h3>
<ul style="list-style-type: disc; list-style-position: outside; padding-left: 40px; margin-bottom: 15px;">
<li style="margin-bottom: 8px;">One game, winner take all.</li>
<li style="margin-bottom: 8px;">Ten buckets are arranged in a triangle on each side of the court.
  <ul style="list-style-type: circle; list-style-position: outside; padding-left: 40px; margin-top: 8px;">
    <li style="margin-bottom: 8px;">The distance between the two front buckets shall be 15 feet.</li>
    <li style="margin-bottom: 8px;">All buckets are partially filled with water.</li>
  </ul>
</li>
<li style="margin-bottom: 8px;">Each team takes turns throwing two balls (one per teammate) into the other's buckets.
  <ul style="list-style-type: circle; list-style-position: outside; padding-left: 40px; margin-top: 8px;">
    <li style="margin-bottom: 8px;">Once a ball lands in a bucket (aka "hits" the bucket), that bucket is taken away.</li>
    <li style="margin-bottom: 8px;">If both teammates hit buckets, the balls are returned and they get to shoot again.</li>
    <li style="margin-bottom: 8px;">The team that successfully hits all of the opponent's buckets first wins the game.</li>
    <li style="margin-bottom: 8px;">If the defending team catches or swats the ball before it hits the ground or a bucket, one bucket is removed of the throwing team's choice.</li>
  </ul>
</li>
<li style="margin-bottom: 8px;">All throws must be taken from behind the bucket line (the line where the last row of buckets are set up).</li>
<li style="margin-bottom: 8px;">First throw is decided by "Eyes." A player from each team throws the ball while maintaining eye contact with their opponent throughout their toss.
  <ul style="list-style-type: circle; list-style-position: outside; padding-left: 40px; margin-top: 8px;">
    <li style="margin-bottom: 8px;">If both players miss or both players make it, their partners now throw.</li>
    <li style="margin-bottom: 8px;">This goes on until one person makes it and their opponent does not.</li>
    <li style="margin-bottom: 8px;">The hit bucket is not removed.</li>
  </ul>
</li>
<li style="margin-bottom: 8px;">Each team can twice request the buckets to be re-racked at the start of their turn.
  <ul style="list-style-type: circle; list-style-position: outside; padding-left: 40px; margin-top: 8px;">
    <li style="margin-bottom: 8px;">If the team gets balls back after making two buckets in a row, it is still considered their turn and they may not get a re-rack.</li>
  </ul>
</li>
<li style="margin-bottom: 8px;">If the ball hits off the ground and then goes into a bucket, the bucket that the ball goes into is removed, as well as another bucket of the defending player's choice.
  <ul style="list-style-type: circle; list-style-position: outside; padding-left: 40px; margin-top: 8px;">
    <li style="margin-bottom: 8px;">If there are only two buckets remaining, the bounce only counts as one cup.</li>
    <li style="margin-bottom: 8px;">As soon as the ball hits off the ground, the defending team is allowed to catch or swat the ball away.</li>
  </ul>
</li>
<li style="margin-bottom: 8px;">If the ball gets wedged between multiple buckets, it counts as a miss (i.e. no buckets are removed)</li>
<li style="margin-bottom: 8px;">If one bucket is hit and the teammate hits the same bucket before the first ball is pulled out, this is worth three cups (two additional chosen by the defending team).</li>
<li style="margin-bottom: 8px;">After the last bucket is hit, each player from the losing team has a chance to hit the remaining buckets (aka rebuttal). Each player shoots until they miss. Once both players miss and there are remaining buckets, the game is over. If the players manage to hit all remaining buckets, the game goes into a three bucket overtime.</li>
<li style="margin-bottom: 8px;">The following variations of pong are not included: NBA Jam On Fire, fingering, blowing, Island/Solo Cup, Rollbacks, or any others not explicitly permitted here.</li>
</ul>

<p style="margin-top: 15px;"><strong>Overtime</strong></p>
<ul style="list-style-type: disc; list-style-position: outside; padding-left: 40px; margin-bottom: 15px;">
<li style="margin-bottom: 8px;">Three cups are placed back into a triangle shape.</li>
<li style="margin-bottom: 8px;">The would-have-been winners shoot first.</li>
<li style="margin-bottom: 8px;">There are no re-racks permitted in overtime.</li>
<li style="margin-bottom: 8px;">Rebuttals are allowed in overtime. Double overtimes (and more) are played if necessary.</li>
</ul>

<p style="margin-top: 15px;"><strong>20-Minute Rule:</strong> If the allotted time expires, the team with the fewest buckets remaining wins.</p>

<p style="margin-top: 15px;"><em>Please reset the buckets after you complete your game so the next teams can play.</em></p>
</div>`,

            'Cornhole': `<div style="padding: 0 20px;">
<h3 style="font-weight: bold; margin-bottom: 10px; margin-top: 20px;">General</h3>
<ul style="list-style-type: disc; list-style-position: outside; padding-left: 40px; margin-bottom: 15px;">
<li style="margin-bottom: 8px;">One game, winner take all.</li>
<li style="margin-bottom: 8px;">First team to reach or exceed 21 points wins the game.</li>
<li style="margin-bottom: 8px;">Boards are placed 21 feet apart (front edge to front edge of each board).</li>
<li style="margin-bottom: 8px;">One player from each team is on each side.</li>
<li style="margin-bottom: 8px;">Round consists of one person from each team throwing four cornhole bags. The players will alternate tosses.</li>
<li style="margin-bottom: 8px;">Whichever team had the last bag on the board or in the hole will then begin the next round. The two opponents will alternate throws.</li>
</ul>

<p style="margin-top: 15px;"><strong>Scoring</strong></p>
<ul style="list-style-type: disc; list-style-position: outside; padding-left: 40px; margin-bottom: 15px;">
<li style="margin-bottom: 8px;">Only one team receives points each round.</li>
<li style="margin-bottom: 8px;">A team receives 1 point for each bag on the board.</li>
<li style="margin-bottom: 8px;">A team receives 3 points for each bag in the hole.</li>
<li style="margin-bottom: 8px;">After adding each team's score, subtract the lesser score from the greater score to determine the total points for the team that scored more points.</li>
</ul>

<p style="margin-top: 15px;"><strong>Notes</strong></p>
<ul style="list-style-type: disc; list-style-position: outside; padding-left: 40px; margin-bottom: 15px;">
<li style="margin-bottom: 8px;">If a bag touches grass at any point, it is deemed dead and does not count even if it lands on the board.</li>
<li style="margin-bottom: 8px;">When tossing a bag, the thrower's feet must not cross the front edge of the board.</li>
<li style="margin-bottom: 8px;">Rocks paper scissors shoot (first to win one) to see which team tosses the first bag.</li>
<li style="margin-bottom: 8px;">Team does <u>not</u> have to win by two or more points. First team to 21 wins.</li>
</ul>

<p style="margin-top: 15px;"><strong>20-Minute Rule:</strong> If neither team reaches 21 points at the end of 20 minutes, the team with the most points wins.</p>
</div>`,

            'BULZiBUCKET': `<div style="padding: 0 20px;">
<h3 style="font-weight: bold; margin-bottom: 10px; margin-top: 20px;">General</h3>
<ul style="list-style-type: disc; list-style-position: outside; padding-left: 40px; margin-bottom: 15px;">
<li style="margin-bottom: 8px;">One game, winner take all.</li>
<li style="margin-bottom: 8px;">First team to reach or exceed 21 points wins the game. Must win by 2 or more points.</li>
<li style="margin-bottom: 8px;">Buckets are placed 15 feet apart.</li>
<li style="margin-bottom: 8px;">One player from each team is on each side.</li>
<li style="margin-bottom: 8px;">Round consists of one person from each team throwing three bags. The players will alternate tosses.</li>
<li style="margin-bottom: 8px;">The last bag thrown each round by each team member is known as the "Money Bag" and is worth double points. Typically the bag with the black mark is saved for last, but if this bag is thrown first or second it is not the "Money Bag" -- only the last bag thrown by each team member each round is the "Money Bag"</li>
<li style="margin-bottom: 8px;">Whichever team won the previous round begins the next round. The two opponents will alternate throws.</li>
</ul>

<p style="margin-top: 15px;"><strong>Scoring</strong></p>
<ul style="list-style-type: disc; list-style-position: outside; padding-left: 40px; margin-bottom: 15px;">
<li style="margin-bottom: 8px;">Only one team receives points each round.</li>
<li style="margin-bottom: 8px;">A team receives:
  <ul style="list-style-type: circle; list-style-position: outside; padding-left: 40px; margin-top: 8px;">
    <li style="margin-bottom: 8px;">1 point for landing the bag into the large bottom bucket.</li>
    <li style="margin-bottom: 8px;">2 points for the middle tier bucket.</li>
    <li style="margin-bottom: 8px;">3 points for the small top bucket.</li>
  </ul>
</li>
<li style="margin-bottom: 8px;">The Money Bag is worth double points.</li>
<li style="margin-bottom: 8px;">After adding each team's score, subtract the lesser score from the greater score to determine the total points for the team that scored more points.</li>
</ul>

<p style="margin-top: 15px;"><strong>Assisting ("Hacking")</strong></p>
<ul style="list-style-type: disc; list-style-position: outside; padding-left: 40px; margin-bottom: 15px;">
<li style="margin-bottom: 8px;">Bags that fly over or to the side of the bucket may be hacked by a player on the same team into the buckets.</li>
<li style="margin-bottom: 8px;">Hacking may be done with the <u>player's feet only</u>.</li>
<li style="margin-bottom: 8px;"><strong>Hacking assists may only occur behind or to the side of the bucket and <u>not over the top</u> of the bucket in back board fashion.</strong></li>
<li style="margin-bottom: 8px;">If any part of the body touches the bucket during an assist, the bag thrown must be pulled if scored and NO points are awarded for that toss.</li>
</ul>

<p style="margin-top: 15px;"><strong>Notes</strong></p>
<ul style="list-style-type: disc; list-style-position: outside; padding-left: 40px; margin-bottom: 15px;">
<li style="margin-bottom: 8px;">If a bag touches grass at any point, it is deemed dead and does not count even if it lands in a bucket.</li>
<li style="margin-bottom: 8px;">When tossing a bag, the thrower's feet must be behind the bucket.</li>
<li style="margin-bottom: 8px;">Rocks paper scissors shoot (first to win one) to see which team tosses the first bag.</li>
</ul>

<p style="margin-top: 15px;"><strong>20-Minute Rule:</strong> If neither team reaches 21 points at the end of 20 minutes, the team with the most points wins.</p>
</div>`,

            'Ladder Ball': `<div style="padding: 0 20px;">
<h3 style="font-weight: bold; margin-bottom: 10px; margin-top: 20px;">General</h3>
<ul style="list-style-type: disc; list-style-position: outside; padding-left: 40px; margin-bottom: 15px;">
<li style="margin-bottom: 8px;">One game, winner take all.</li>
<li style="margin-bottom: 8px;">First team to reach or exceed 21 points wins the game. Must win by 2 or more points.</li>
<li style="margin-bottom: 8px;">Ladders are placed 15 feet apart.</li>
<li style="margin-bottom: 8px;">One player from each team is on each side.</li>
<li style="margin-bottom: 8px;">The goal of the game is to throw each bola at your opponent's ladder rungs and have them stick or wrap around the structure.</li>
<li style="margin-bottom: 8px;">Each player throws all three of their bolas before another player can go.</li>
<li style="margin-bottom: 8px;">Whichever team won the previous round begins the next round.</li>
</ul>

<p style="margin-top: 15px;"><strong>Scoring</strong></p>
<ul style="list-style-type: disc; list-style-position: outside; padding-left: 40px; margin-bottom: 15px;">
<li style="margin-bottom: 8px;">Only one team receives points each round.</li>
<li style="margin-bottom: 8px;">A team receives:
  <ul style="list-style-type: circle; list-style-position: outside; padding-left: 40px; margin-top: 8px;">
    <li style="margin-bottom: 8px;">3 points for bola on the top rung.</li>
    <li style="margin-bottom: 8px;">2 points for bola on the middle rung.</li>
    <li style="margin-bottom: 8px;">1 point for bola on the bottom rung.</li>
  </ul>
</li>
<li style="margin-bottom: 8px;">After adding each team's score, subtract the lesser score from the greater score to determine the total points for the team that scored more points.</li>
</ul>

<p style="margin-top: 15px;"><strong>Notes</strong></p>
<ul style="list-style-type: disc; list-style-position: outside; padding-left: 40px; margin-bottom: 15px;">
<li style="margin-bottom: 8px;">Bolas must be thrown from behind the ladder.</li>
<li style="margin-bottom: 8px;">Bolas can be tossed any way the player chooses (e.g. does not have to be underhand).</li>
<li style="margin-bottom: 8px;">Each bola must be thrown separately.</li>
<li style="margin-bottom: 8px;">Bolas that touch or bounce off the grass still count for points if they end up on a ladder rung.</li>
<li style="margin-bottom: 8px;">If one bola is hanging from another bola, it counts for the same points as the bola it is hanging onto. For example, if one bola is hanging on the three point rung and another bola is hanging from this bola, then the other bola is also counted as hanging on the three point rung.</li>
<li style="margin-bottom: 8px;">If a bola is knocked off a rung, it will not count toward the end-of-round score.</li>
<li style="margin-bottom: 8px;">Rocks paper scissors shoot (first to win one) to see which team goes first.</li>
</ul>

<p style="margin-top: 15px;"><strong>20-Minute Rule:</strong> If neither team reaches 21 points at the end of 20 minutes, the team with the most points wins.</p>
</div>`,

            'Bean Bag Memory Match': `<div style="padding: 0 20px;">
<div style="float: right; margin: 0 0 20px 20px; max-width: 250px;">
<img src="https://i.imgur.com/3W3kOMf.png" alt="Bean Bag Memory Match Setup" style="width: 100%; height: auto; border: 1px solid #ddd; border-radius: 8px;">
</div>

<h3 style="font-weight: bold; margin-bottom: 10px; margin-top: 20px;">General</h3>
<ul style="list-style-type: disc; list-style-position: outside; padding-left: 40px; margin-bottom: 15px;">
<li style="margin-bottom: 8px;">One game, winner take all.</li>
<li style="margin-bottom: 8px;">First team to flip over every lid with a Match wins.</li>
<li style="margin-bottom: 8px;">Both players are on the same side.</li>
<li style="margin-bottom: 8px;">Each round consists of one person from each team throwing two bean bags.</li>
</ul>

<h3 style="font-weight: bold; margin-bottom: 10px; margin-top: 20px;">Setup</h3>
<ul style="list-style-type: disc; list-style-position: outside; padding-left: 40px; margin-bottom: 15px;">
<li style="margin-bottom: 8px;">At the beginning of the game, the lids are placed face down in the formation shown to the right. 4 lids are in the first row, 4 in the second row, and 4 in the third row. There are roughly 2 to 4 inches of space between each lid and 8 feet separate the front of the lid structures.</li>
<li style="margin-bottom: 8px;">Lids are positioned randomly without looking at what picture is underneath.</li>
</ul>

<h3 style="font-weight: bold; margin-bottom: 10px; margin-top: 20px;">Order of Play</h3>
<ul style="list-style-type: disc; list-style-position: outside; padding-left: 40px; margin-bottom: 15px;">
<li style="margin-bottom: 8px;">The game begins with rocks paper scissors shoot (first to win one). The team that wins ("Team A") will toss first.</li>
<li style="margin-bottom: 8px;">Standing behind their own lids, the first player from Team A tosses two bean bags at Team B's lids.</li>
<li style="margin-bottom: 8px;">The first player from Team B tosses two bean bags at Team A's lids.</li>
<li style="margin-bottom: 8px;">The second player from Team A tosses two bean bags at Team B's lids.</li>
<li style="margin-bottom: 8px;">The second player from Team B tosses two bean bags at Team A's lids.</li>
<li style="margin-bottom: 8px;">Play continues in this order until the end of the game.</li>
</ul>

<div style="clear: both;"></div>

<h3 style="font-weight: bold; margin-bottom: 10px; margin-top: 20px;">Flipping Lids, Matches, and Mismatches</h3>
<ul style="list-style-type: disc; list-style-position: outside; padding-left: 40px; margin-bottom: 15px;">
<li style="margin-bottom: 8px;">The first lid that the bean bag hits in the air is flipped upright, revealing the picture.</li>
<li style="margin-bottom: 8px;">This lid remains upright until another lid is hit and flipped upright.</li>
<li style="margin-bottom: 8px;">If the next lid hit and flipped upright matches the other flipped lid, this is a Match and the two lids remain upright for the remainder of the game.</li>
<li style="margin-bottom: 8px;">If the next lid hit and flipped upright does not match the other flipped lid, this is a Mismatch and both lids are flipped back down revealing the pictures again. Remember what the pictures are!</li>
<li style="margin-bottom: 8px;">If there is a lid flipped upright at the end of a turn (after two bean bag tosses), it remains upright for the next turn and until there is a Mismatch when both lids in the Mismatch are flipped back down.</li>
</ul>

<p style="margin-top: 15px;"><strong>Notes</strong></p>
<ul style="list-style-type: disc; list-style-position: outside; padding-left: 40px; margin-bottom: 15px;">
<li style="margin-bottom: 8px;">If the bean bag hits the ground first, it is dead.</li>
<li style="margin-bottom: 8px;">If the bean bag hits a lid and the ground simultaneously, it counts as a lid hit (not a dead bag).</li>
<li style="margin-bottom: 8px;">If the bean bag hits a lid and then falls off and/or is touching the ground, it counts as a lid hit.</li>
<li style="margin-bottom: 8px;">If the bean bag hits one lid and then ends up on another lid, the first lid is flipped (not the second).</li>
<li style="margin-bottom: 8px;">If a bean bag hits two lids simultaneously, whichever lid it ends up on (or is covering more of) is the one considered hit.</li>
<li style="margin-bottom: 8px;">If a bean bag hits a lid that is already upright, it is a dead bag (and the lid remains upright).</li>
<li style="margin-bottom: 8px;">First team to flip all lids with Matches wins. There is no last chances or overtime.</li>
</ul>

<p style="margin-top: 15px;"><strong>20-Minute Rule:</strong> If neither team flips all lids by the 20 minute mark, whichever team has more Matches wins. If the teams are tied in Matches, then play continues until one team gets another Match.</p>
</div>`,

            'QB54': `<div style="padding: 0 20px;">
<h3 style="font-weight: bold; margin-bottom: 10px; margin-top: 20px;">General</h3>
<ul style="list-style-type: disc; list-style-position: outside; padding-left: 40px; margin-bottom: 15px;">
<li style="margin-bottom: 8px;">One game, winner take all.</li>
<li style="margin-bottom: 8px;">First team to reach or exceed 54 points wins the game (with the exception of a Hail Mary). Must win by 2 or more points.</li>
<li style="margin-bottom: 8px;">Chairs are placed 30 feet apart.</li>
<li style="margin-bottom: 8px;">Teammates play on the same side together.</li>
<li style="margin-bottom: 8px;">Players alternate throws.</li>
</ul>

<h3 style="font-weight: bold; margin-bottom: 10px; margin-top: 20px;">Order of Play</h3>
<ul style="list-style-type: disc; list-style-position: outside; padding-left: 40px; margin-bottom: 15px;">
<li style="margin-bottom: 8px;">The game begins with rocks paper scissors shoot (first to win one). The team that wins will throw first.</li>
<li style="margin-bottom: 8px;">Standing behind the chair, the player throws the football at the opposing chair.</li>
<li style="margin-bottom: 8px;">Play alternates with each team throwing only once (both teammates do not throw the ball on each turn).</li>
</ul>

<h3 style="font-weight: bold; margin-bottom: 10px; margin-top: 20px;">Scoring</h3>
<ul style="list-style-type: disc; list-style-position: outside; padding-left: 40px; margin-bottom: 15px;">
<li style="margin-bottom: 8px;">3 points for Completion -- Hit <em>any part</em> of the chair/goalposts before the ball hits the ground.</li>
<li style="margin-bottom: 8px;">6 points for Touchdown -- Throw the ball into the basket before the ball hits the ground.
  <ul style="list-style-type: circle; list-style-position: outside; padding-left: 40px; margin-top: 8px;">
    <li style="margin-bottom: 8px;">Defense cannot try to knock the ball out of the basket</li>
  </ul>
</li>
<li style="margin-bottom: 8px;">1 point for Extra Point after TD -- Kick the ball through the uprights. Ball is kicked at the midway point between the two chairs. The extra point is good if the ball is higher than the uprights but still through them.</li>
<li style="margin-bottom: 8px;">2 points for Safety -- If the thrown ball bounces off the ground and into the basket, the defending team gets 2 points. The ball is dead and there is no safety if ball hits any part of the defending team's bodies.</li>
<li style="margin-bottom: 8px;">3 points for Interception -- Defensive team catches a rebound off of the chair.
  <ul style="list-style-type: circle; list-style-position: outside; padding-left: 40px; margin-top: 8px;">
    <li style="margin-bottom: 8px;">The ball must be in the air off of a bounce to be intercept -- it cannot be lifted off the chair</li>
  </ul>
</li>
<li style="margin-bottom: 8px;">3 points for Defensive Interference -- Defensive team interferes with a ball that likely would have hit the chair before it makes contact with the chair</li>
<li style="margin-bottom: 8px;">The Fitz -- If you kick the ball into the basket during an Extra Point after TD you win the game immediately.</li>
<li style="margin-bottom: 8px;">First team to 54 points (by 2) wins.</li>
<li style="margin-bottom: 8px;">Losing team gets one Hail Mary chance.
  <ul style="list-style-type: circle; list-style-position: outside; padding-left: 40px; margin-top: 8px;">
    <li style="margin-bottom: 8px;">Subtract the winning score by the losing score to determine the steps (e.g. 54 points - 34 points = 20) (20 steps away from your goal).</li>
    <li style="margin-bottom: 8px;">Take the number of steps (e.g. 20) with feet touching away from your chair. This is the place to throw the Hail Mary.</li>
    <li style="margin-bottom: 8px;">If a touchdown is thrown from the Hail Mary pass you win. A miss and you lose.</li>
  </ul>
</li>
</ul>

<p style="margin-top: 15px;"><strong>Notes</strong></p>
<ul style="list-style-type: disc; list-style-position: outside; padding-left: 40px; margin-bottom: 15px;">
<li style="margin-bottom: 8px;">Defensive team does not have to stand behind the chair -- players can stand on the side or even in front of (but not blocking) the chair.</li>
<li style="margin-bottom: 8px;">Defensive players cannot touch the ball in midair if it has a reasonable chance of hitting the chair.</li>
<li style="margin-bottom: 8px;">Teams switch sides when the leading team reaches 12, 24, 36, and 48 points.</li>
</ul>

<p style="margin-top: 15px;"><strong>20-Minute Rule:</strong> If neither team reaches 54 points at the end of 20 minutes, the team with the most points wins (pending Hail Mary). Losing team still gets their Hail Mary chance.</p>
</div>`,

            'Soccer Bocce': `<div style="padding: 0 20px;">
<h3 style="font-weight: bold; margin-bottom: 10px; margin-top: 20px;">General</h3>
<ul style="list-style-type: disc; list-style-position: outside; padding-left: 40px; margin-bottom: 15px;">
<li style="margin-bottom: 8px;">One game, winner take all.</li>
<li style="margin-bottom: 8px;">First team to 7 points wins the game.</li>
<li style="margin-bottom: 8px;">Soccer Bocce is played with eight small soccer balls and one smaller target called a pallina.</li>
<li style="margin-bottom: 8px;">There are four soccer balls per team and they are made of a different color (red and yellow) to distinguish the balls of one team from those of the other team.</li>
<li style="margin-bottom: 8px;">Each player kicks two balls.</li>
</ul>

<h3 style="font-weight: bold; margin-bottom: 10px; margin-top: 20px;">Order of Play</h3>
<ul style="list-style-type: disc; list-style-position: outside; padding-left: 40px; margin-bottom: 15px;">
<li style="margin-bottom: 8px;">The game begins with rocks paper scissors shoot (first to win one). The team that wins can choose to either have the first toss of the pallina or the color of the balls they will use.</li>
<li style="margin-bottom: 8px;">To start the game, the pallina is rolled or tossed roughly 20 to 40 feet (~10 to 20 steps). A marker is dropped where the pallina was tossed from. If the distance between the marker and pallina is significantly less than 20 feet or more than 40 feet, the pallina should be picked up and manually moved to an acceptable distance.</li>
<li style="margin-bottom: 8px;">The player tossing the pallina must kick the first soccer ball. All balls are kicked from the marker.</li>
<li style="margin-bottom: 8px;">The opposing team then kicks their balls until one of its soccer balls is closer to the pallina or has kicked all of its balls.</li>
<li style="margin-bottom: 8px;">The "nearest ball" rule governs the sequence of kicked balls.
  <ul style="list-style-type: circle; list-style-position: outside; padding-left: 40px; margin-top: 8px;">
    <li style="margin-bottom: 8px;">The side whose ball is closest to the pallina is called the "in" ball and the opposing side the "out" ball.</li>
    <li style="margin-bottom: 8px;">Whenever a team gets "in", it steps aside and allows the "out" team to deliver.</li>
    <li style="margin-bottom: 8px;">The other team kicks until it gets its ball closer to the pallina.</li>
    <li style="margin-bottom: 8px;">This continues until both teams have kicked all their soccer balls.</li>
  </ul>
</li>
<li style="margin-bottom: 8px;">After both teams have exhausted all their balls, a frame is over and points are awarded.</li>
<li style="margin-bottom: 8px;">The team that was awarded points in the previous frame begins the next frame by tossing the pallina into play.</li>
</ul>

<h3 style="font-weight: bold; margin-bottom: 10px; margin-top: 20px;">Scoring</h3>
<ul style="list-style-type: disc; list-style-position: outside; padding-left: 40px; margin-bottom: 15px;">
<li style="margin-bottom: 8px;">At the end of each frame, points will be awarded.</li>
<li style="margin-bottom: 8px;">Only one team scores in a frame. A team scores between 1 and 4 points per frame.</li>
<li style="margin-bottom: 8px;">One point is awarded for each ball that is closer to the pallina than the closest ball of the opposing team.</li>
<li style="margin-bottom: 8px;">In the event that the closest ball of each team is the same distance from the pallina, no points will be awarded and the pallina returns to the team that delivered it.</li>
<li style="margin-bottom: 8px;">Only balls which are distinguishably closer to the pallina than any of the opponent's balls are awarded points.</li>
<li style="margin-bottom: 8px;">All measurements should be made from the center of the pallina to the edge of a soccer ball.</li>
<li style="margin-bottom: 8px;">If a soccer ball is touching the pallina, an extra point is awarded.</li>
</ul>

<p style="margin-top: 15px;"><strong>20-Minute Rule:</strong> If the allotted time expires, the team with the highest point total wins.</p>

<p style="margin-top: 15px;"><em>Please put the balls and pallina next to each other after you complete your game so the next teams can play.</em></p>
</div>`
        };
        
        const OVERVIEW_TEXT = `
<div style="padding: 0 20px;">
<h2 style="text-decoration: underline; font-style: italic; margin-bottom: 20px;">Overview</h2>

<h3 style="font-weight: bold; margin-bottom: 10px; margin-top: 20px;">General</h3>
<ul style="list-style-type: disc; list-style-position: outside; padding-left: 40px; margin-bottom: 15px;">
  <li style="margin-bottom: 10px;">Teams of two players compete in 9 events against random different teams for each event.
    <ul style="list-style-type: circle; list-style-position: outside; padding-left: 40px; margin-top: 8px;">
      <li style="margin-bottom: 8px;">Teams may compete against each other twice in different events</li>
    </ul>
  </li>
  <li style="margin-bottom: 10px;">Each event lasts strictly 20 minutes.</li>
  <li style="margin-bottom: 10px;">After completing your event, please reset it for the next teams that play.</li>
</ul>

<div style="height: 20px;"></div>

<h3 style="font-weight: bold; margin-bottom: 10px; margin-top: 20px;">Events</h3>
<ul style="list-style-type: disc; list-style-position: outside; padding-left: 40px; margin-bottom: 15px;">
  <li style="margin-bottom: 5px;"><span style="color: #8b5cf6; cursor: pointer; text-decoration: underline;" onclick="showRules('Mölkky')">Mölkky</span></li>
  <li style="margin-bottom: 5px;"><span style="color: #8b5cf6; cursor: pointer; text-decoration: underline;" onclick="showRules('Bocce')">Bocce</span></li>
  <li style="margin-bottom: 5px;"><span style="color: #8b5cf6; cursor: pointer; text-decoration: underline;" onclick="showRules('Giant Pong')">Giant Pong</span></li>
  <li style="margin-bottom: 5px;"><span style="color: #8b5cf6; cursor: pointer; text-decoration: underline;" onclick="showRules('Cornhole')">Cornhole</span></li>
  <li style="margin-bottom: 5px;"><span style="color: #8b5cf6; cursor: pointer; text-decoration: underline;" onclick="showRules('BULZiBUCKET')">BULZiBUCKET</span></li>
  <li style="margin-bottom: 5px;"><span style="color: #8b5cf6; cursor: pointer; text-decoration: underline;" onclick="showRules('Ladder Ball')">Ladder Ball</span></li>
  <li style="margin-bottom: 5px;"><span style="color: #8b5cf6; cursor: pointer; text-decoration: underline;" onclick="showRules('QB54')">QB54</span></li>
  <li style="margin-bottom: 5px;"><span style="color: #8b5cf6; cursor: pointer; text-decoration: underline;" onclick="showRules('Soccer Bocce')">Soccer Bocce</span></li>
  <li style="margin-bottom: 5px;"><span style="color: #8b5cf6; cursor: pointer; text-decoration: underline;" onclick="showRules('Bean Bag Memory Match')">Bean Bag Memory Match</span></li>
</ul>

<h3 style="font-weight: bold; margin-bottom: 10px; margin-top: 20px;">Playoffs</h3>
<ul style="list-style-type: disc; list-style-position: outside; padding-left: 40px; margin-bottom: 15px;">
  <li style="margin-bottom: 10px;">The top 10 teams advance to the playoffs.
    <ul style="list-style-type: circle; list-style-position: outside; padding-left: 40px; margin-top: 8px;">
      <li style="margin-bottom: 8px;">Tiebreakers are solved with the "point wagering" system designed at the outset.</li>
      <li style="margin-bottom: 8px;">Higher Seed goes first to start off each game.</li>
    </ul>
  </li>
  <li style="margin-bottom: 10px;">Wild Card Round
    <ul style="list-style-type: circle; list-style-position: outside; padding-left: 40px; margin-top: 8px;">
      <li style="margin-bottom: 8px;">The top 6 seeds get a bye and do not participate in the Wild Card Round.</li>
      <li style="margin-bottom: 8px;">7<sup>th</sup> seed plays 10<sup>th</sup> seed and 8<sup>th</sup> seed plays 9<sup>th</sup> seed.</li>
      <li style="margin-bottom: 8px;">Each team plays Giant Pong with only 3 buckets (vs the usual 10) in a fast-paced single elimination playoff. There is no overtime.</li>
      <li style="margin-bottom: 8px;">Both games are played simultaneously.</li>
    </ul>
  </li>
  <li style="margin-bottom: 10px;">Remaining Playoff Rounds
    <ul style="list-style-type: circle; list-style-position: outside; padding-left: 40px; margin-top: 8px;">
      <li style="margin-bottom: 8px;">1 vs. 8, 2 vs. 7, 3 vs. 6, 4 vs. 5 in the next round.</li>
      <li style="margin-bottom: 8px;">All rules remain the same for each game except for the Wild Card Round.</li>
      <li style="margin-bottom: 8px;">In subsequent rounds, the highest remaining seed will play the lowest remaining seed, etc.</li>
    </ul>
  </li>
  <li style="margin-bottom: 10px;">Choice of Games
    <ul style="list-style-type: circle; list-style-position: outside; padding-left: 40px; margin-top: 8px;">
      <li style="margin-bottom: 8px;">For each game in the playoffs, the highest seed team will pick a game out of a hat.</li>
      <li style="margin-bottom: 8px;">Once the game is picked, the higher seed has the choice to play that game or redraw among the remaining events. Only one redraw (veto) is allowed.</li>
      <li style="margin-bottom: 8px;">Once two teams are given a game to play, the next highest seed picks one of the remaining games out of a hat.</li>
    </ul>
  </li>
  <li style="margin-bottom: 10px;">The Finals will be a combination of 3 events, "best of" style.
    <ul style="list-style-type: circle; list-style-position: outside; padding-left: 40px; margin-top: 8px;">
      <li style="margin-bottom: 8px;">Top seed picks first and third events (game of team's choice, <em>not out of the hat</em>). Second team picks second event. All events are picked before the first event is played.</li>
      <li style="margin-bottom: 8px;">Each team can veto TWO selections by the other team (e.g. a team may say the other team cannot choose Giant Pong or Cornhole). Vetos by each team are declared <em>before</em> the teams announce their selections.</li>
    </ul>
  </li>
  <li style="margin-bottom: 10px;">In the event of a TIE for playoff seeding (same record and same point total based on their wagers):
    <ul style="list-style-type: circle; list-style-position: outside; padding-left: 40px; margin-top: 8px;">
      <li style="margin-bottom: 8px;">1<sup>st</sup> tiebreaker: head-to-head record -- if one has beaten the other, that team is the higher seed.</li>
      <li style="margin-bottom: 8px;">If teams did not play each other, then rocks paper scissors shoot will decide order (first to win 1).
        <ul style="list-style-type: square; list-style-position: outside; padding-left: 40px; margin-top: 8px;">
          <li style="margin-bottom: 8px;">If two teams meet in the playoffs with same point total and seeding determined by rocks paper scissors, the game will be pulled from the hat with no option to veto.</li>
        </ul>
      </li>
    </ul>
  </li>
</ul>
</div>`;

        async function loadData() {
            if (BACKEND_URL === 'YOUR_SCRIPT_URL_HERE') {
                state.connectionStatus = 'error';
                render();
                return;
            }
            
            // Don't load if we saved recently - prevents overwriting unsaved local changes
            const timeSinceLastSave = Date.now() - lastSaveTime;
            if (timeSinceLastSave < 15000) {
                console.log(`Skipping load - saved ${Math.round(timeSinceLastSave/1000)}s ago`);
                return;
            }

            // Don't load while a save is in progress
            if (isSaving) {
                console.log('Skipping load - save in progress');
                return;
            }
            
            try {
                state.connectionStatus = 'loading';
                const response = await fetch(BACKEND_URL);
                if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
                
                const serverData = await response.json();
                
                if (serverData.teamNames) {
                    try { data.teamNames = JSON.parse(serverData.teamNames); } catch(e) { data.teamNames = {}; }
                }
                if (serverData.wagers) {
                    try { data.wagers = JSON.parse(serverData.wagers); } catch(e) { data.wagers = {}; }
                }
                if (serverData.results) {
                    try { data.results = JSON.parse(serverData.results); } catch(e) { data.results = {}; }
                }
                
                state.connectionStatus = 'connected';
                render();
            } catch (e) {
                console.error('Error loading data:', e);
                state.connectionStatus = 'error';
            }
        }

        async function saveData() {
            if (BACKEND_URL === 'https://script.google.com/macros/s/AKfycbz6vM4Rs_BvIp3XwxzpodTMCDfM1JWQPWYK3iGM3ECX1e8IofEJxyEzgHn_RUuhNU53yw/exec') return;
            if (isSaving) return; // Prevent concurrent saves
            
            isSaving = true;
            state.connectionStatus = 'loading';
            
            try {
                const payload = {
                    teamNames: JSON.stringify(data.teamNames),
                    wagers: JSON.stringify(data.wagers),
                    results: JSON.stringify(data.results)
                };
                
                // Try GET first (works with Google Apps Script without CORS issues)
                // Fall back to POST if URL would be too long
                const params = new URLSearchParams({ action: 'save', data: JSON.stringify(payload) });
                const getUrl = `${BACKEND_URL}?${params.toString()}`;
                
                let response;
                if (getUrl.length < 2000) {
                    // Use GET for smaller payloads (most reliable with Google Apps Script)
                    response = await fetch(getUrl);
                } else {
                    // Use POST for larger payloads (teams 15-20 with full data)
                    response = await fetch(BACKEND_URL, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
                        body: params.toString()
                    });
                }
                
                if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
                const result = await response.json();
                if (result.error) throw new Error(result.error);
                
                state.connectionStatus = 'connected';
                console.log('Data saved successfully');
            } catch (e) {
                console.error('Error saving data:', e);
                state.connectionStatus = 'error';
            } finally {
                isSaving = false;
            }
        }

        function getTeamName(num) {
            return data.teamNames[num] || `Team ${num}`;
        }

        function getResultKey(time, t1, t2, event) {
            return `${time}_${t1}_${t2}_${event}`;
        }

        function getResult(time, t1, t2, event) {
            return data.results[getResultKey(time, t1, t2, event)];
        }

        function saveResult(time, t1, t2, event, winner) {
            const key = getResultKey(time, t1, t2, event);
            if (data.results[key] === winner) {
                delete data.results[key];
            } else {
                data.results[key] = winner;
            }
            lastSaveTime = Date.now();

            // Update buttons in-place without full re-render (Fix #1: prevents scroll jumping to top)
            const winBtn = document.querySelector(`[data-result-key="${key}-win"]`);
            const loseBtn = document.querySelector(`[data-result-key="${key}-lose"]`);
            if (winBtn && loseBtn) {
                const result = data.results[key];
                // Win button is active when result equals t1 (the selected team who clicked Win)
                const winActive = result !== undefined && result === t1;
                // Lose button is active when result equals t2 (the opponent)
                const loseActive = result !== undefined && result === t2;
                winBtn.className = 'win-btn' + (winActive ? ' active' : '');
                loseBtn.className = 'lose-btn' + (loseActive ? ' active' : '');
            } else {
                render();
            }
            saveData();
        }

        function getTeamSchedule(teamNum) {
            const schedule = [];
            SCHEDULE.forEach(slot => {
                if (slot.matches[0][2] === 'Pizza!') {
                    schedule.push({ time: slot.time, event: 'Pizza!', opponent: null });
                    return;
                }
                slot.matches.forEach(m => {
                    if (m[0] === teamNum) {
                        schedule.push({ time: slot.time, event: m[2], opponent: m[1], team1: m[0], team2: m[1] });
                    } else if (m[1] === teamNum) {
                        schedule.push({ time: slot.time, event: m[2], opponent: m[0], team1: m[0], team2: m[1] });
                    }
                });
            });
            return schedule;
        }

        function calculateStandings() {
            const standings = [];
            for (let i = 1; i <= 20; i++) {
                let wins = 0, losses = 0, wagerPoints = 0;
                const teamWagers = data.wagers[i] || {};
                SCHEDULE.forEach(slot => {
                    if (slot.matches[0][2] === 'Pizza!') return;
                    slot.matches.forEach(m => {
                        if (m[2] === 'Break') return;
                        const result = getResult(slot.time, m[0], m[1], m[2]);
                        if (m[0] === i && result !== undefined) {
                            if (result === m[0]) {
                                wins++;
                                wagerPoints += teamWagers[m[2]] || 0;
                            } else losses++;
                        } else if (m[1] === i && result !== undefined) {
                            if (result === m[1]) {
                                wins++;
                                wagerPoints += teamWagers[m[2]] || 0;
                            } else losses++;
                        }
                    });
                });
                standings.push({ team: i, name: getTeamName(i), wins, losses, wagerPoints });
            }
            standings.sort((a, b) => b.wins !== a.wins ? b.wins - a.wins : b.wagerPoints - a.wagerPoints);
            return standings;
        }

        function render() {
            console.time('render');
            
            // Save scroll position before rendering (only restore for views where it matters)
            const scrollPos = window.pageYOffset || document.documentElement.scrollTop;
            const preserveScroll = (state.view === 'results' || state.view === 'wagers' || state.view === 'standings');
            
            const app = document.getElementById('app');
            if (state.view === 'team-select') {
                app.innerHTML = `
                    <h1 class="title">🏆 10th Annual Silvalympics</h1>
                    <div class="team-grid">
                        ${[...Array(20)].map((_, i) => `
                            <button class="team-btn" onclick="selectTeam(${i+1})">
                                <div class="team-num">Team ${i+1}</div>
                                <div class="team-name">${getTeamName(i+1)}</div>
                            </button>
                        `).join('')}
                    </div>
                    <div class="button-container">
                        <button class="toggle-schedule-btn" onclick="state.view='admin'; render()">Admin Controls</button>
                    </div>
                `;
            } else if (state.view === 'menu') {
                const teamScheduleEnabled = schedulesEnabled && (!data.disabledSchedules || !data.disabledSchedules[state.selectedTeam]);
                const scheduleBtn = teamScheduleEnabled
                    ? '<button class="menu-btn purple" onclick="state.view=\'schedule\'; render()">📅 View Schedule</button>'
                    : '<button class="menu-btn purple disabled" style="pointer-events: none;">📅 View Schedule</button>';
                
                app.innerHTML = `
                    <button class="back-btn" onclick="state.view='team-select'; render()">← Back to Team Selection</button>
                    <div class="card">
                        <h2 class="card-title">${getTeamName(state.selectedTeam)}</h2>
                        <button class="menu-btn blue" onclick="state.view='team-names'; render()">👥 Enter Team Names</button>
                        <button class="menu-btn green" onclick="state.view='wagers'; render()">🎯 Set Wagers</button>
                        ${scheduleBtn}
                        <button class="menu-btn orange" onclick="state.view='results'; render()">🏆 Enter Results</button>
                        <button class="menu-btn red" onclick="state.view='standings'; render()">📊 View Standings</button>
                        <button class="menu-btn blue" onclick="state.view='overview'; render()" style="background: #6366f1;">📋 Silvalympics Overview</button>
                    </div>
                `;
            } else if (state.view === 'team-names') {
                // Pre-populate with existing names (Update #6)
                const existingNames = data.teamNames[state.selectedTeam] || '';
                const parts = existingNames.split(' & ');
                const existingName1 = parts[0] || '';
                const existingName2 = parts[1] || '';
                app.innerHTML = `
                    <button class="back-btn" onclick="state.view='menu'; render()">← Back to Menu</button>
                    <div class="card">
                        <h2 class="card-title">Team ${state.selectedTeam} Names</h2>
                        <div class="input-group">
                            <label>Player 1</label>
                            <input type="text" id="name1" placeholder="Enter name" value="${existingName1}">
                        </div>
                        <div class="input-group">
                            <label>Player 2</label>
                            <input type="text" id="name2" placeholder="Enter name" value="${existingName2}">
                        </div>
                        <button class="menu-btn purple" onclick="saveTeamNames()">Save Names</button>
                    </div>
                `;
            } else if (state.view === 'wagers') {
                const teamWagers = data.wagers[state.selectedTeam] || {};
                const total = Object.values(teamWagers).reduce((sum, val) => sum + (parseInt(val) || 0), 0);
                const totalClass = total === 50 ? 'valid' : 'invalid';
                const canEditWagers = wagersEnabled && (!data.disabledWagers || !data.disabledWagers[state.selectedTeam]);
                const disabledAttr = canEditWagers ? '' : 'disabled';
                const readOnlyMessage = canEditWagers ? '' : '<div style="background: #fee2e2; color: #991b1b; border-radius: 8px; padding: 15px; margin-bottom: 20px; text-align: center; font-weight: bold;">⚠️ Wager editing is currently disabled. You can view but not change your wagers.</div>';
                
                app.innerHTML = `
                    <button class="back-btn" onclick="state.view='menu'; render()">← Back to Menu</button>
                    <div class="card">
                        <h2 class="card-title">Set Wagers</h2>
                        ${readOnlyMessage}
                        <div style="background: #f3f4f6; border-radius: 8px; padding: 15px; margin-bottom: 20px; text-align: left;">
                            <ul style="margin: 0; padding-left: 20px; color: #666; font-size: 14px; line-height: 1.6;">
                                <li>Wager must be between 1 and 20 for each event.</li>
                                <li>Total of wagers must add up to 50.</li>
                                <li>Wagers cannot be changed after the event starts.</li>
                                <li>In the event of a tied win / loss record, playoff seeds will be determined by these wagers … so think carefully!</li>
                            </ul>
                        </div>
                        <div class="total ${totalClass}">Total: ${total} / 50</div>
                        ${canEditWagers ? `<button class="menu-btn" onclick="randomizeWagers()" style="background: #8b5cf6; margin-bottom: 15px;">
                            🎲 Randomize Wagers
                        </button>` : ''}
                        <div class="scrollable">
                            ${EVENTS.map(event => `
                                <div class="wager-row">
                                    <label style="color: #8b5cf6; cursor: pointer; text-decoration: underline;" onclick="showRules('${event}')">${event}</label>
                                    <input type="number" min="1" max="20" value="${teamWagers[event] || ''}" 
                                        ${disabledAttr} 
                                        onchange="updateWager('${event}', this.value)"
                                        onfocus="this.dataset.focused='true'"
                                        onblur="this.dataset.focused='false'">
                                </div>
                            `).join('')}
                        </div>
                        ${canEditWagers ? `<button class="menu-btn purple ${state.wagersSaved ? 'saved' : ''}" 
                            onmousedown="saveWagersOnMousedown(event)">${state.wagersSaved ? '✓ Wagers Saved!' : 'Save Wagers'}</button>` : ''}
                    </div>
                `;
            } else if (state.view === 'schedule') {
                const schedule = getTeamSchedule(state.selectedTeam);
                app.innerHTML = `
                    <button class="back-btn" onclick="state.view='menu'; render()">← Back to Menu</button>
                    <div class="card">
                        <h2 class="card-title">${getTeamName(state.selectedTeam)} Schedule</h2>
                        <div class="scrollable">
                            ${schedule.map(item => `
                                <div class="schedule-item">
                                    <div class="schedule-time">${item.time}</div>
                                    <div class="schedule-event" style="${item.event !== 'Break' && item.event !== 'Pizza!' ? 'cursor: pointer; text-decoration: underline;' : ''}" 
                                        ${item.event !== 'Break' && item.event !== 'Pizza!' ? `onclick="showRules('${item.event}')"` : ''}>
                                        ${item.event}
                                    </div>
                                    ${item.opponent && item.event !== 'Break' ? `<div class="schedule-vs">vs ${getTeamName(item.opponent)}</div>` : ''}
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;
            } else if (state.view === 'results') {
                const schedule = getTeamSchedule(state.selectedTeam);
                app.innerHTML = `
                    <button class="back-btn" onclick="state.view='menu'; render()">← Back to Menu</button>
                    <div class="card">
                        <h2 class="card-title">Enter Results</h2>
                        <div class="scrollable">
                            ${schedule.map(item => {
                                if (!item.opponent || item.event === 'Break' || item.event === 'Pizza!') return '';
                                const result = getResult(item.time, item.team1, item.team2, item.event);
                                const didWin = result === state.selectedTeam;
                                const didLose = result !== undefined && result !== state.selectedTeam;
                                const key = getResultKey(item.time, item.team1, item.team2, item.event);
                                return `
                                    <div class="schedule-item">
                                        <div class="schedule-time">${item.time} - ${item.event}</div>
                                        <div class="schedule-vs">vs ${getTeamName(item.opponent)}</div>
                                        <div class="result-btns">
                                            <button class="win-btn ${didWin ? 'active' : ''}" 
                                                data-result-key="${key}-win"
                                                onclick="saveResult('${item.time}', ${item.team1}, ${item.team2}, '${item.event}', ${state.selectedTeam})">Win</button>
                                            <button class="lose-btn ${didLose ? 'active' : ''}" 
                                                data-result-key="${key}-lose"
                                                onclick="saveResult('${item.time}', ${item.team1}, ${item.team2}, '${item.event}', ${item.opponent})">Lose</button>
                                        </div>
                                    </div>
                                `;
                            }).join('')}
                        </div>
                    </div>
                `;
            } else if (state.view === 'standings') {
                const standings = calculateStandings();
                app.innerHTML = `
                    <button class="back-btn" onclick="state.view='menu'; render()">← Back to Menu</button>
                    <div class="card">
                        <h2 class="card-title">Live Standings</h2>
                        <div class="scrollable">
                            ${standings.map((team, idx) => {
                                let bgClass = 'standing-red', badgeClass = '', badgeText = '';
                                if (idx < 6) {
                                    bgClass = 'standing-green';
                                    badgeClass = 'badge-green';
                                    badgeText = '🏆 BYE';
                                } else if (idx < 10) {
                                    bgClass = 'standing-blue';
                                    badgeClass = 'badge-blue';
                                    badgeText = '🎯 PLAYOFF';
                                }
                                return `
                                    <div class="standing ${bgClass}">
                                        <div class="standing-left">
                                            <div class="standing-rank">${idx + 1}</div>
                                            <div>
                                                <div class="standing-name">${team.name}</div>
                                                <div class="standing-record">${team.wins}-${team.losses} (${team.wagerPoints} pts)</div>
                                            </div>
                                        </div>
                                        ${badgeText ? `<div class="standing-badge ${badgeClass}">${badgeText}</div>` : ''}
                                    </div>
                                `;
                            }).join('')}
                        </div>
                        <div class="info-box">
                            <div><strong>Playoff Format:</strong></div>
                            <div>🟢 Top 6: First Round BYE</div>
                            <div>🔵 Seeds 7-10: Wild Card Round</div>
                            <div>🔴 Seeds 11-20: Eliminated</div>
                        </div>
                    </div>
                `;
            } else if (state.view === 'rules') {
                const backView = state.returnTo || 'schedule';
                app.innerHTML = `
                    <button class="back-btn" onclick="state.view='${backView}'; render()">← Back to ${backView === 'overview' ? 'Overview' : 'Schedule'}</button>
                    <div class="card">
                        <h2 class="card-title">${state.currentEvent} Rules</h2>
                        <div class="scrollable" style="text-align: left;">
                            ${EVENT_RULES[state.currentEvent] || '<p>Rules not available</p>'}
                        </div>
                    </div>
                `;
            } else if (state.view === 'overview') {
                app.innerHTML = `
                    <button class="back-btn" onclick="state.view='menu'; render()">← Back to Menu</button>
                    <div class="card">
                        <h2 class="card-title">Silvalympics Overview</h2>
                        <div class="scrollable" style="text-align: left;">
                            ${OVERVIEW_TEXT}
                        </div>
                    </div>
                `;
            } else if (state.view === 'admin') {
                app.innerHTML = `
                    <button class="back-btn" onclick="state.view='team-select'; render()">← Back to Team Selection</button>
                    <div class="card">
                        <h2 class="card-title">Admin Controls</h2>
                        <p style="text-align: center; color: #666; margin-bottom: 30px;">Administrative functions for managing the Silvalympics</p>
                        <button class="menu-btn orange" onclick="state.view='toggle-schedules-menu'; render()">🔄 Toggle Schedules</button>
                        <button class="menu-btn blue" onclick="state.view='toggle-wagers-menu'; render()">🎯 Toggle Wagers</button>
                        <button class="menu-btn red" onclick="clearAllData()">🗑️ Clear All Data</button>
                    </div>
                `;
            } else if (state.view === 'toggle-schedules-menu') {
                app.innerHTML = `
                    <button class="back-btn" onclick="state.view='admin'; render()">← Back to Admin Controls</button>
                    <div class="card">
                        <h2 class="card-title">Toggle Schedules</h2>
                        <p style="text-align: center; color: #666; margin-bottom: 30px;">Choose how to toggle schedule access</p>
                        <button class="menu-btn orange" onclick="toggleAllSchedules()">🔄 Toggle Schedules (All Teams)</button>
                        <button class="menu-btn purple" onclick="state.view='toggle-individual'; render()">🔄 Toggle Schedules (Individual Team)</button>
                    </div>
                `;
            } else if (state.view === 'toggle-wagers-menu') {
                app.innerHTML = `
                    <button class="back-btn" onclick="state.view='admin'; render()">← Back to Admin Controls</button>
                    <div class="card">
                        <h2 class="card-title">Toggle Wagers</h2>
                        <p style="text-align: center; color: #666; margin-bottom: 30px;">Choose how to toggle wager editing</p>
                        <button class="menu-btn blue" onclick="toggleAllWagers()">🎯 Toggle Wagers (All Teams)</button>
                        <button class="menu-btn green" onclick="state.view='toggle-wagers-individual'; render()">🎯 Toggle Wagers (Individual Team)</button>
                    </div>
                `;
            } else if (state.view === 'toggle-individual') {
                app.innerHTML = `
                    <button class="back-btn" onclick="state.view='toggle-schedules-menu'; render()">← Back to Toggle Schedules</button>
                    <div class="card">
                        <h2 class="card-title">Toggle Schedule - Select Team</h2>
                        <p style="text-align: center; color: #666; margin-bottom: 20px;">Select a team to toggle their schedule access</p>
                        <div class="team-grid">
                            ${[...Array(20)].map((_, i) => {
                                const teamNum = i + 1;
                                const hasSchedule = !data.disabledSchedules || !data.disabledSchedules[teamNum];
                                return `
                                    <button class="team-btn" onclick="toggleIndividualSchedule(${teamNum})" style="position: relative;">
                                        <div class="team-num">Team ${teamNum}</div>
                                        <div class="team-name">${getTeamName(teamNum)}</div>
                                        <div style="position: absolute; top: 5px; right: 5px; font-size: 20px;">
                                            ${hasSchedule ? '✅' : '❌'}
                                        </div>
                                    </button>
                                `;
                            }).join('')}
                        </div>
                    </div>
                `;
            } else if (state.view === 'toggle-wagers-individual') {
                app.innerHTML = `
                    <button class="back-btn" onclick="state.view='toggle-wagers-menu'; render()">← Back to Toggle Wagers</button>
                    <div class="card">
                        <h2 class="card-title">Toggle Wagers - Select Team</h2>
                        <p style="text-align: center; color: #666; margin-bottom: 20px;">Select a team to toggle their wager editing ability</p>
                        <div class="team-grid">
                            ${[...Array(20)].map((_, i) => {
                                const teamNum = i + 1;
                                const canEditWagers = !data.disabledWagers || !data.disabledWagers[teamNum];
                                return `
                                    <button class="team-btn" onclick="toggleIndividualWagers(${teamNum})" style="position: relative;">
                                        <div class="team-num">Team ${teamNum}</div>
                                        <div class="team-name">${getTeamName(teamNum)}</div>
                                        <div style="position: absolute; top: 5px; right: 5px; font-size: 20px;">
                                            ${canEditWagers ? '✅' : '❌'}
                                        </div>
                                    </button>
                                `;
                            }).join('')}
                        </div>
                    </div>
                `;
            }
            console.timeEnd('render');
            
            // Restore scroll position after rendering (only for views where position should be preserved)
            if (preserveScroll) {
                window.scrollTo(0, scrollPos);
            } else {
                window.scrollTo(0, 0);
            }
        }

        function selectTeam(num) {
            state.selectedTeam = num;
            state.view = 'menu';
            render();
        }
        
        function showRules(eventName) {
            state.returnTo = state.view; // Save current view before switching
            state.view = 'rules';
            state.currentEvent = eventName;
            render();
        }

        function saveTeamNames() {
            const name1 = document.getElementById('name1').value;
            const name2 = document.getElementById('name2').value;
            if (name1 && name2) {
                data.teamNames[state.selectedTeam] = `${name1} & ${name2}`;
                state.view = 'menu';
                lastSaveTime = Date.now(); // Block auto-refresh
                render(); // Update UI immediately
                saveData(); // Save in background (no await)
            }
        }

        function updateWager(event, value) {
            const val = parseInt(value) || 0;
            if (!data.wagers[state.selectedTeam]) data.wagers[state.selectedTeam] = {};
            if (val >= 1 && val <= 20) {
                data.wagers[state.selectedTeam][event] = val;
            } else if (val === 0 || value === '') {
                delete data.wagers[state.selectedTeam][event];
            }
            // Update total display without full re-render (avoids focus loss / double-click issue)
            const teamWagers = data.wagers[state.selectedTeam] || {};
            const total = Object.values(teamWagers).reduce((sum, v) => sum + (parseInt(v) || 0), 0);
            const totalEl = document.querySelector('.total');
            if (totalEl) {
                totalEl.textContent = `Total: ${total} / 50`;
                totalEl.className = `total ${total === 50 ? 'valid' : 'invalid'}`;
            }
        }

        function saveWagersOnMousedown(e) {
            // Prevent default so the button click fires before blur steals focus
            e.preventDefault();
            // Flush any active input first
            const activeEl = document.activeElement;
            if (activeEl && activeEl.tagName === 'INPUT') {
                updateWager(activeEl.closest('.wager-row')?.querySelector('label')?.textContent?.trim() || '', activeEl.value);
            }
            saveWagers();
        }

        function saveWagers() {
            const teamWagers = data.wagers[state.selectedTeam] || {};
            const events = Object.keys(teamWagers);

            // Update #5: validate each wager
            for (const event of EVENTS) {
                const val = teamWagers[event];
                if (val === undefined || val === '' || val === null) {
                    alert(`Please enter a wager for ${event}.`);
                    return;
                }
                const num = parseInt(val);
                if (isNaN(num) || num <= 0 || num > 20) {
                    alert(`Wager for ${event} must be between 1 and 20.`);
                    return;
                }
            }

            const total = Object.values(teamWagers).reduce((sum, val) => sum + (parseInt(val) || 0), 0);
            if (total !== 50) {
                alert(`Wagers must total exactly 50. Current total: ${total}`);
                return;
            }

            lastSaveTime = Date.now();
            state.wagersSaved = true;
            saveData(); // Save in background
            // Update #3: go back to team menu after saving
            setTimeout(() => {
                state.wagersSaved = false;
                state.view = 'menu';
                render();
            }, 800);
        }

        async function clearAllData() {
            const code = prompt('Enter 4-digit code to clear all data:');
            if (code === '0820') {
                if (confirm('Are you SURE you want to clear ALL data? This cannot be undone!')) {
                    data.teamNames = {};
                    data.wagers = {};
                    data.results = {};
                    lastSaveTime = Date.now();
                    await saveData();
                    alert('All data cleared!');
                    state.view = 'team-select';
                    render();
                }
            } else if (code !== null) {
                alert('Incorrect code!');
            }
        }
        
        function toggleAllSchedules() {
            const code = prompt('Enter 4-digit code to toggle schedules for all teams:');
            if (code === '0820') {
                schedulesEnabled = !schedulesEnabled;
                alert(schedulesEnabled ? 'Schedules enabled for all teams!' : 'Schedules disabled for all teams!');
                render();
            } else if (code !== null) {
                alert('Incorrect code!');
            }
        }
        
        function toggleIndividualSchedule(teamNum) {
            const code = prompt(`Enter 4-digit code to toggle schedule for Team ${teamNum}:`);
            if (code === '0820') {
                if (!data.disabledSchedules) data.disabledSchedules = {};
                
                // Toggle: if currently disabled, enable it (remove from list); if enabled, disable it (add to list)
                if (data.disabledSchedules[teamNum]) {
                    delete data.disabledSchedules[teamNum];
                    alert(`Schedule enabled for Team ${teamNum}!`);
                } else {
                    data.disabledSchedules[teamNum] = true;
                    alert(`Schedule disabled for Team ${teamNum}!`);
                }
                
                lastSaveTime = Date.now();
                render();
                saveData();
            } else if (code !== null) {
                alert('Incorrect code!');
            }
        }
        
        function toggleAllWagers() {
            const code = prompt('Enter 4-digit code to toggle wagers for all teams:');
            if (code === '0820') {
                wagersEnabled = !wagersEnabled;
                alert(wagersEnabled ? 'Wager editing enabled for all teams!' : 'Wager editing disabled for all teams!');
                render();
            } else if (code !== null) {
                alert('Incorrect code!');
            }
        }
        
        function toggleIndividualWagers(teamNum) {
            const code = prompt(`Enter 4-digit code to toggle wagers for Team ${teamNum}:`);
            if (code === '0820') {
                if (!data.disabledWagers) data.disabledWagers = {};
                
                // Toggle: if currently disabled, enable it (remove from list); if enabled, disable it (add to list)
                if (data.disabledWagers[teamNum]) {
                    delete data.disabledWagers[teamNum];
                    alert(`Wager editing enabled for Team ${teamNum}!`);
                } else {
                    data.disabledWagers[teamNum] = true;
                    alert(`Wager editing disabled for Team ${teamNum}!`);
                }
                
                lastSaveTime = Date.now();
                render();
                saveData();
            } else if (code !== null) {
                alert('Incorrect code!');
            }
        }
        
        function randomizeWagers() {
            const wagerData = {};
            let remaining = 50;
            const events = [...EVENTS];
            
            // Assign random wagers between 1-20 for first 8 events
            for (let i = 0; i < 8; i++) {
                const min = Math.max(1, remaining - (20 * (8 - i)));
                const max = Math.min(20, remaining - (8 - i));
                const wager = Math.floor(Math.random() * (max - min + 1)) + min;
                wagerData[events[i]] = wager;
                remaining -= wager;
            }
            
            // Last event gets whatever is remaining
            wagerData[events[8]] = remaining;
            
            if (!data.wagers[state.selectedTeam]) data.wagers[state.selectedTeam] = {};
            data.wagers[state.selectedTeam] = wagerData;
            render();
        }

        (async () => {
            // Render immediately so user sees the interface right away
            render();
            
            // Load data in background
            await loadData();
            
            // Set up auto-refresh interval (every 20s - gives saves enough time to complete before re-loading)
            setInterval(async () => {
                if (state.view === 'team-select' || state.view === 'menu' || state.view === 'schedule' || state.view === 'results' || state.view === 'standings') {
                    await loadData();
                }
            }, 20000);
        })();
    </script>
</body>
</html>
