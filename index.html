<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>10th Annual Silvalympics</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Arial, sans-serif; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; }
        .container { max-width: 800px; margin: 0 auto; padding: 20px; }
        .title { color: white; text-align: center; font-size: 32px; font-weight: bold; margin-bottom: 30px; }
        .team-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; }
        @media (min-width: 768px) { .team-grid { grid-template-columns: repeat(4, 1fr); } }
        .team-btn { background: white; padding: 20px; border-radius: 10px; border: none; cursor: pointer; box-shadow: 0 4px 6px rgba(0,0,0,0.1); transition: transform 0.2s; }
        .team-btn:hover { transform: scale(1.05); box-shadow: 0 6px 12px rgba(0,0,0,0.15); }
        .team-num { color: #667eea; font-weight: bold; font-size: 18px; margin-bottom: 5px; }
        .team-name { color: #666; font-size: 14px; }
        .card { background: white; border-radius: 15px; padding: 25px; box-shadow: 0 8px 16px rgba(0,0,0,0.1); }
        .back-btn { color: white; background: none; border: none; cursor: pointer; margin-bottom: 15px; font-size: 16px; }
        .back-btn:hover { text-decoration: underline; }
        .card-title { color: #667eea; font-size: 24px; font-weight: bold; text-align: center; margin-bottom: 25px; }
        .menu-btn { width: 100%; padding: 15px; margin-bottom: 12px; border: none; border-radius: 8px; font-size: 16px; font-weight: 600; cursor: pointer; color: white; transition: opacity 0.2s; }
        .menu-btn:hover { opacity: 0.9; }
        .blue { background: #3b82f6; }
        .green { background: #10b981; }
        .purple { background: #8b5cf6; }
        .orange { background: #f59e0b; }
        .red { background: #ef4444; }
        .input-group { margin-bottom: 20px; }
        .input-group label { display: block; font-weight: 600; margin-bottom: 5px; color: #333; }
        .input-group input { width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px; font-size: 16px; }
        .wager-row { display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px; }
        .wager-row label { flex: 1; font-size: 14px; }
        .wager-row input { width: 80px; padding: 8px; text-align: center; border: 1px solid #ddd; border-radius: 6px; }
        .total { font-size: 18px; font-weight: bold; margin: 20px 0; }
        .total.valid { color: #10b981; }
        .total.invalid { color: #ef4444; }
        .schedule-item { border: 1px solid #e5e7eb; border-radius: 8px; padding: 15px; margin-bottom: 12px; background: #f9fafb; }
        .schedule-time { font-weight: bold; font-size: 18px; margin-bottom: 5px; }
        .schedule-event { color: #8b5cf6; font-weight: 600; margin-bottom: 3px; }
        .schedule-vs { color: #666; font-size: 14px; }
        .result-btns { display: flex; gap: 10px; margin-top: 10px; }
        .result-btns button { flex: 1; padding: 10px; border: none; border-radius: 6px; font-weight: 600; cursor: pointer; }
        .win-btn { background: #d1fae5; color: #065f46; }
        .win-btn.active { background: #10b981; color: white; }
        .lose-btn { background: #fee2e2; color: #991b1b; }
        .lose-btn.active { background: #ef4444; color: white; }
        .standing { display: flex; align-items: center; justify-content: space-between; padding: 12px; border-radius: 8px; margin-bottom: 8px; }
        .standing-green { background: #d1fae5; }
        .standing-blue { background: #dbeafe; }
        .standing-red { background: #fee2e2; }
        .standing-left { display: flex; align-items: center; gap: 15px; flex: 1; }
        .standing-rank { font-size: 24px; font-weight: bold; color: #999; width: 30px; }
        .standing-name { font-weight: 600; color: #333; }
        .standing-record { color: #666; font-size: 14px; }
        .standing-badge { font-size: 12px; font-weight: bold; }
        .badge-green { color: #065f46; }
        .badge-blue { color: #1e40af; }
        .scrollable { max-height: 500px; overflow-y: auto; }
        .info-box { background: #f3f4f6; border-radius: 8px; padding: 15px; margin-top: 20px; font-size: 14px; }
        .info-box div { margin-bottom: 5px; color: #666; }
        .saved { background: #10b981 !important; }
        .hide { display: none; }
        .status { position: fixed; top: 10px; right: 10px; padding: 8px 12px; border-radius: 20px; font-size: 12px; font-weight: bold; z-index: 1000; }
        .status-connected { background: #10b981; color: white; }
        .status-error { background: #ef4444; color: white; }
        .status-loading { background: #f59e0b; color: white; }
        .clear-data-btn { position: fixed; bottom: 10px; right: 10px; padding: 8px 12px; background: #ef4444; color: white; border: none; border-radius: 6px; font-size: 12px; cursor: pointer; z-index: 1000; }
        .clear-data-btn:hover { background: #dc2626; }
        .toggle-schedule-btn { position: fixed; bottom: 10px; right: 110px; padding: 8px 12px; background: #f59e0b; color: white; border: none; border-radius: 6px; font-size: 12px; cursor: pointer; z-index: 1000; }
        .toggle-schedule-btn:hover { background: #ea580c; }
        .disabled { opacity: 0.5; cursor: not-allowed !important; background: #9ca3af !important; }
    </style>
</head>
<body>
    <div class="container" id="app"></div>

    <script>
        const EVENTS = ['Mölkky', 'Bocce', 'Giant Pong', 'Cornhole', 'BULZiBUCKET', 'Ladder Ball', 'QB54', 'Soccer Bocce', 'Bean Bag Memory Match'];
        
        const SCHEDULE = [
            { time: '10:40am', matches: [
                [1,2,'Giant Pong'],[3,4,'BULZiBUCKET'],[5,6,'Mölkky'],[7,8,'Cornhole'],[9,10,'Bocce'],
                [11,12,'Ladder Ball'],[13,14,'QB54'],[19,16,'Soccer Bocce'],[17,20,'Bean Bag Memory Match'],[15,18,'Break']
            ]},
            { time: '11:00am', matches: [
                [4,5,'Giant Pong'],[6,7,'BULZiBUCKET'],[8,9,'Mölkky'],[10,11,'Cornhole'],[12,13,'Bocce'],
                [14,3,'Ladder Ball'],[16,17,'QB54'],[18,15,'Soccer Bocce'],[1,19,'Bean Bag Memory Match'],[20,2,'Break']
            ]},
            { time: '11:20am', matches: [
                [6,8,'Giant Pong'],[10,12,'BULZiBUCKET'],[14,16,'Mölkky'],[18,20,'Cornhole'],[2,4,'Bocce'],
                [5,7,'Ladder Ball'],[9,11,'QB54'],[1,17,'Soccer Bocce'],[3,15,'Bean Bag Memory Match'],[13,19,'Break']
            ]},
            { time: '11:40am', matches: [
                [7,9,'Giant Pong'],[11,13,'BULZiBUCKET'],[15,17,'Mölkky'],[19,1,'Cornhole'],[3,5,'Bocce'],
                [4,6,'Ladder Ball'],[8,10,'QB54'],[20,12,'Soccer Bocce'],[2,18,'Bean Bag Memory Match'],[16,14,'Break']
            ]},
            { time: '12:00pm', matches: [
                [10,14,'Giant Pong'],[18,2,'BULZiBUCKET'],[7,11,'Mölkky'],[15,3,'Cornhole'],[19,8,'Bocce'],
                [16,20,'Ladder Ball'],[5,12,'QB54'],[4,6,'Soccer Bocce'],[9,13,'Bean Bag Memory Match'],[17,1,'Break']
            ]},
            { time: '12:20pm', matches: [[0,0,'Pizza!']] },
            { time: '12:40pm', matches: [
                [11,15,'Giant Pong'],[19,9,'BULZiBUCKET'],[3,12,'Mölkky'],[4,16,'Cornhole'],[20,17,'Bocce'],
                [8,13,'Ladder Ball'],[1,18,'QB54'],[10,2,'Soccer Bocce'],[14,7,'Bean Bag Memory Match'],[6,5,'Break']
            ]},
            { time: '1:00pm', matches: [
                [20,19,'Giant Pong'],[15,16,'BULZiBUCKET'],[4,10,'Mölkky'],[2,17,'Cornhole'],[18,6,'Bocce'],
                [1,9,'Ladder Ball'],[7,3,'QB54'],[14,13,'Soccer Bocce'],[11,5,'Bean Bag Memory Match'],[8,12,'Break']
            ]},
            { time: '1:20pm', matches: [
                [18,3,'Giant Pong'],[14,20,'BULZiBUCKET'],[2,13,'Mölkky'],[9,12,'Cornhole'],[1,16,'Bocce'],
                [19,17,'Ladder Ball'],[6,15,'QB54'],[7,5,'Soccer Bocce'],[4,8,'Bean Bag Memory Match'],[11,10,'Break']
            ]},
            { time: '1:40pm', matches: [
                [13,16,'Giant Pong'],[17,5,'BULZiBUCKET'],[1,20,'Mölkky'],[6,14,'Cornhole'],[11,7,'Bocce'],
                [18,15,'Ladder Ball'],[19,2,'QB54'],[9,8,'Soccer Bocce'],[12,10,'Bean Bag Memory Match'],[4,3,'Break']
            ]},
            { time: '2:00pm', matches: [
                [12,17,'Giant Pong'],[8,1,'BULZiBUCKET'],[19,18,'Mölkky'],[5,13,'Cornhole'],[15,14,'Bocce'],
                [2,10,'Ladder Ball'],[4,20,'QB54'],[11,3,'Soccer Bocce'],[16,6,'Bean Bag Memory Match'],[9,7,'Break']
            ]}
        ];

        // REPLACE THIS URL WITH YOUR GOOGLE APPS SCRIPT WEB APP URL
        const BACKEND_URL = 'https://script.google.com/macros/s/AKfycbz6vM4Rs_BvIp3XwxzpodTMCDfM1JWQPWYK3iGM3ECX1e8IofEJxyEzgHn_RUuhNU53yw/exec';
        
        let state = { view: 'team-select', selectedTeam: null, wagersSaved: false, connectionStatus: 'loading' };
        let data = { teamNames: {}, wagers: {}, results: {} };
        let lastUserAction = Date.now();
        let isSaving = false;
        let lastSaveTime = 0;
        let schedulesEnabled = true;
        
        const EVENT_RULES = {
            'Mölkky': `<h3>General</h3>
<ul>
<li>One game, winner take all.</li>
<li>Game consists of twelve skittles (i.e. pins) numbered from 1 to 12 and one Mölkky throwing skittle.</li>
<li>Game is 2-on-2.</li>
<li>Object is to get exactly 50 points.</li>
<li>The Mölkky throwing skittle may be thrown any way, for example underhand, overhand, or sideways. It may also bounce on the grass.</li>
</ul>
<br>

<h3>Order of Play</h3>
<ul>
<li>The game begins with rocks paper scissors shoot (first to win one).</li>
<li>One of the teammates from the team that wins starts the game by tossing the Mölkky throwing skittle.</li>
<li>One of the teammates from the other team then tosses the Mölkky throwing skittle.</li>
<li>Teams and teammates continue rotating tosses for the rest of the game.</li>
</ul>
<br>

<h3>Setup</h3>
<ul>
<li>At the beginning of the game, the skittles are placed in this formation:</li>
</ul>

<div style="text-align: center; margin: 20px 0;">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJYAAACWCAYAAAA8AXHiAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAF8klEQVR4nO3dS3LbMBAFUIry/a9sL1J2sqgkMh8GBvqh31NVcZxYljgzL0MQlPjz5+/XH8D/5a/0DwD/R1gIEBYChIUAYSFAWAgQFgKEhQBhIUBYCBAWAoSFAGEhQFgIEBYChIUAYSFAWAgQFgKEhQBhIUBYCBAWAoSFAGEhQFgIEBYChIUAYSFAWAgQFgKEhQBhIUBYCBAWAoSFAGEhQFgIEBYChIUAYSFAWAgQFgKEhQBhIUBYCBAWAoSFAGEhQFgIEBYChIUAYSFAWAgQFgKEhQBhIUBYCBAWAoSFAGEhQFgIEBYChIUAYSFAWAgQFgKEhQBhIUBYCBAWAoSFAGEhQFgIEBYChIUAYSFAWAgQFgKEhQBhIUBYCBAWAoSFAGEhQFgIEBYChIUAYSFAWAgQFgKEhQBhIUBYCBAWAoSFAGEhQFgIEBYChIUAYSFAWAgQFgKEhQBhIUBYCBAWAoSFAGEhQFgIEBYChIUAYSFAWAgQFgKEhQBhIUBYCBAWAoSFAGEhQFgIEBYChIUAYSFAWAgQFgKEhQBhIUBYCBAWAoSFAGEhQFgIEBYChIUAYSFAWAgQFgKEhQBhIUBYCBAWAoSFAGEhQFgIEBYChIUAYSFAWAgQFgKEhQBhIUBYCBAWAoSFAGEhQFgIEBYChIUAYSFAWAgQFgKEhQBhIUBYCBAWAoSFAGEhQFgIEBYChIUAYSFAWAgQFgKEhQBhIUBYCBAWAoSFAGEhQFgIEBYChIUAYSFAWAgQFgKEhQBhIUBYCBAWAoSFAGEhQFgIEBYChIUAYSFAWAgQFgKEhQBhIUBYCBAWAoSFAGEhQFgIEBYChIUAYSFAWAgQFgKEhQBhIUBYCBAWAoSFAGEhQFgIEBYChIUAYSFAWAgQFgKEhQBhIUBYCBAWAoSFAGEhQFgIEBYChIUAYSFAWAgQFgKEhQBhIUBYCBAWAoSFAGEhQFgIEBYChIUAYSFAWAgQFgKEhQBhIUBYCBAWAoSFAGEhQFgIEBYChIUAYSFAWAgQFgKEhQBhIUBYCBAWAoSFAGEhQFgIEBYChIUAYSFAWAgQFgKEhQBhIUBYCBAWAoSFAGEhQFgIEBYChIUAYSFAWAgQFgKEhQBhIUBYCBAWAoSFAGEhQFgIEBYChIUAYSFAWAgQFgKEhQBhIUBYCBAWAoSFAGEhQFgIEBYChIUAYSFAWAgQFgKEhQBhIUBYCBAWAoSFAGEhQFgIEBYChIUAYSFAWAgQFgKEhQBhIUBYCBAWAoSFAGEhQFgIEBYChIUAYSFAWAgQFgKEhQBhIUBYCBAWAoSFAGEhQFgIEBYChIUAYSFAWAgQFgKEhQBhIUBYCBAWAoSFAGEhQFgIEBYChIUAYSFAWAgQFgKEhQBhIUBYCBAWAoSFAGEhQFgIEBYChIUAYSFAWAgQFgKEhQBhIUBYCBAWAoSFAGEhQFgIEBYChIUAYSFAWAgQFgKEhQBhIUBYCBAWAoSFAGEhQFgIEBYChIUAYSFAWAgQFgKEhQBhIUBYCBAWAoSFAGEhQFgIEBYChIUAYSFAWAgQFgKEhQBhIUBYCBAWAoSFAGEhQFgIEBYChIUAYSFAWAgQFgKEhQBhIUBYCBAWAoSFAGEhQFgIEBYChIUAYSFAWAgQFgKEhQBhIUBYCBAWAoSFAGEhQFgIEBYChIUAYSFAWAgQFgKEhQBhIUBYCBAWAoSFAGEhQFgIEBYChIUAYSFAWAgQFgKEhQBhIUBYCBAWAoSFAGEhQFgIEBYChIUAYSFAWAgQFgKEhQBhIUBYCBAWAoSFAGEhQFgIEBYChIUAYSFAWAgQFgKEhQBhIUBYCBAWAoSFAGEhQFgIEBYChIUAYSFAWAgQFgKEhQBhIUBYCBAWAoSFAGEhQFgIEBYChIUAYSFAWAgQFgKEhQBhIUBYCBAWAoSFAGEhQFgIEBYChIUAYSFAWAgQFgKEhQBhIUBYCBAWAoSFAGEhQFgIEBYChIUAYSHgL3+6Qp7WGu7sAAAAAElFTkSuQmCC" alt="Mölkky Setup" style="max-width: 200px; height: auto; border: 1px solid #ddd; border-radius: 8px;">
</div>

<ul>
<li>After a throw, fallen skittles are put upright <u>at the place where they fell</u>. As a result, the skittles are naturally spread out as the game progresses.</li>
<li>The throwing line is 10 feet from the front of the skittle formation. The Mölkky throwing skittle may be thrown from anywhere behind the throwing line, including from either side.</li>
</ul>
<br>

<h3>Scoring</h3>
<ul>
<li>If one skittle falls, the score is equal to the number on the pin. When more than one skittle falls, the score is equal to the number of fallen skittles.</li>
<li>A skittle is not considered fallen if it is leaning on another skittle or on the Mölkky throwing skittle.</li>
<li>The game ends when the first team reaches exactly 50 points.</li>
<li>If the team scores over 50, that team's score is lowered to 25.</li>
<li>If a team misses (has no score) three times in a row, that team's score is lowered to 0.</li>
</ul>

<p><strong>20-Minute Rule:</strong> If time expires and neither team has reached exactly 50 points, then the first team that exceeded 50 points wins. If neither team has exceeded 50 points, then whichever team has the most points wins.</p>

<p><em>Please reset the Molkky skittles after you complete your game so the next teams can play.</em></p>`,

            'Bocce': `<h3>General</h3>
<ul>
<li>One game, winner take all.</li>
<li>First team to 7 points wins the game.</li>
<li>Bocce is played with eight large balls and one smaller target ball called a pallina.</li>
<li>There are four balls per team and they are made of a different color to distinguish the balls of one team from those of the other team.</li>
<li>Each player throws two balls.</li>
</ul>
<br>

<h3>Order of Play</h3>
<ul>
<li>The game begins with rocks paper scissors shoot (first to win one). The team that wins can choose to either have the first toss of the pallina or the color of the balls they will use.</li>
<li>To start the game, the pallina is rolled or tossed roughly 20 to 40 feet (~10 to 20 steps). A marker is dropped where the pallina was tossed from. If the distance between the marker and pallina is significantly less than 20 feet or more than 40 feet, the pallina should be picked up and manually moved to an acceptable distance.</li>
<li>The player tossing the pallina must deliver the first Bocce ball. All balls are tossed from the marker.</li>
<li>The opposing team then delivers their balls until one of its Bocce balls is closer to the pallina or has thrown all of its balls.</li>
<li>The "nearest ball" rule governs the sequence of thrown balls.
  <ul>
    <li>The side whose ball is closest to the pallina is called the "in" ball and the opposing side the "out" ball.</li>
    <li>Whenever a team gets "in", it steps aside and allows the "out" team to deliver.</li>
    <li>The other team throws until it gets its ball closer to the pallina.</li>
    <li>This continues until both teams have thrown all their Bocce balls.</li>
  </ul>
</li>
<li>After both teams have exhausted all their balls, a frame is over and points are awarded.</li>
<li>The team that was awarded points in the previous frame begins the next frame by tossing the pallina into play.</li>
</ul>
<br>

<h3>Scoring</h3>
<ul>
<li>At the end of each frame, points will be awarded.</li>
<li>Only one team scores in a frame. A team scores between 1 and 4 points per frame.</li>
<li>One point is awarded for each ball that is closer to the pallina than the closest ball of the opposing team.</li>
<li>In the event that the closest ball of each team is the same distance from the pallina, no points will be awarded and the pallina returns to the team that delivered it.</li>
<li>Only balls which are distinguishably closer to the pallina than any of the opponent's balls are awarded points.</li>
<li>All measurements should be made from the center of the pallina to the edge of a Bocce ball.</li>
<li>If a Bocce ball is touching the pallina, an extra point is awarded.</li>
</ul>

<p><strong>20-Minute Rule:</strong> If the allotted time expires, the team with the highest point total wins.</p>

<p><em>Please put the balls and pallina next to each other after you complete your game so the next teams can play.</em></p>`,

            'Giant Pong': `<h3>General</h3>
<ul>
<li>One game, winner take all.</li>
<li>Ten buckets are arranged in a triangle on each side of the court.
  <ul>
    <li>The distance between the two front buckets shall be 15 feet.</li>
    <li>All buckets are partially filled with water.</li>
  </ul>
</li>
<li>Each team takes turns throwing two balls (one per teammate) into the other's buckets.
  <ul>
    <li>Once a ball lands in a bucket (aka "hits" the bucket), that bucket is taken away.</li>
    <li>If both teammates hit buckets, the balls are returned and they get to shoot again.</li>
    <li>The team that successfully hits all of the opponent's buckets first wins the game.</li>
    <li>If the defending team catches or swats the ball before it hits the ground or a bucket, one bucket is removed of the throwing team's choice.</li>
  </ul>
</li>
<li>All throws must be taken from behind the bucket line (the line where the last row of buckets are set up).</li>
<li>First throw is decided by "Eyes." A player from each team throws the ball while maintaining eye contact with their opponent throughout their toss.
  <ul>
    <li>If both players miss or both players make it, their partners now throw.</li>
    <li>This goes on until one person makes it and their opponent does not.</li>
    <li>The hit bucket is not removed.</li>
  </ul>
</li>
<li>Each team can twice request the buckets to be re-racked at the start of their turn.
  <ul>
    <li>If the team gets balls back after making two buckets in a row, it is still considered their turn and they may not get a re-rack.</li>
  </ul>
</li>
<li>If the ball hits off the ground and then goes into a bucket, the bucket that the ball goes into is removed, as well as another bucket of the defending player's choice.
  <ul>
    <li>If there are only two buckets remaining, the bounce only counts as one cup.</li>
    <li>As soon as the ball hits off the ground, the defending team is allowed to catch or swat the ball away.</li>
  </ul>
</li>
<li>If the ball gets wedged between multiple buckets, it counts as a miss (i.e. no buckets are removed)</li>
<li>If one bucket is hit and the teammate hits the same bucket before the first ball is pulled out, this is worth three cups (two additional chosen by the defending team).</li>
<li>After the last bucket is hit, each player from the losing team has a chance to hit the remaining buckets (aka rebuttal). Each player shoots until they miss. Once both players miss and there are remaining buckets, the game is over. If the players manage to hit all remaining buckets, the game goes into a three bucket overtime.</li>
<li>The following variations of pong are not included: NBA Jam On Fire, fingering, blowing, Island/Solo Cup, Rollbacks, or any others not explicitly permitted here.</li>
</ul>

<p><strong>Overtime</strong></p>
<ul>
<li>Three cups are placed back into a triangle shape.</li>
<li>The would-have-been winners shoot first.</li>
<li>There are no re-racks permitted in overtime.</li>
<li>Rebuttals are allowed in overtime. Double overtimes (and more) are played if necessary.</li>
</ul>

<p><strong>20-Minute Rule:</strong> If the allotted time expires, the team with the fewest buckets remaining wins.</p>

<p><em>Please reset the buckets after you complete your game so the next teams can play.</em></p>`,

            'Cornhole': `<h3>General</h3>
<ul>
<li>One game, winner take all.</li>
<li>First team to reach or exceed 21 points wins the game.</li>
<li>Boards are placed 21 feet apart (front edge to front edge of each board).</li>
<li>One player from each team is on each side.</li>
<li>Round consists of one person from each team throwing four cornhole bags. The players will alternate tosses.</li>
<li>Whichever team had the last bag on the board or in the hole will then begin the next round. The two opponents will alternate throws.</li>
</ul>

<p><strong>Scoring</strong></p>
<ul>
<li>Only one team receives points each round.</li>
<li>A team receives 1 point for each bag on the board.</li>
<li>A team receives 3 points for each bag in the hole.</li>
<li>After adding each team's score, subtract the lesser score from the greater score to determine the total points for the team that scored more points.</li>
</ul>

<p><strong>Notes</strong></p>
<ul>
<li>If a bag touches grass at any point, it is deemed dead and does not count even if it lands on the board.</li>
<li>When tossing a bag, the thrower's feet must not cross the front edge of the board.</li>
<li>Rocks paper scissors shoot (first to win one) to see which team tosses the first bag.</li>
<li>Team does <u>not</u> have to win by two or more points. First team to 21 wins.</li>
</ul>

<p><strong>20-Minute Rule:</strong> If neither team reaches 21 points at the end of 20 minutes, the team with the most points wins.</p>`,

            'BULZiBUCKET': `<h3>General</h3>
<ul>
<li>One game, winner take all.</li>
<li>First team to reach or exceed 21 points wins the game. Must win by 2 or more points.</li>
<li>Buckets are placed 15 feet apart.</li>
<li>One player from each team is on each side.</li>
<li>Round consists of one person from each team throwing three bags. The players will alternate tosses.</li>
<li>The last bag thrown each round by each team member is known as the "Money Bag" and is worth double points. Typically the bag with the black mark is saved for last, but if this bag is thrown first or second it is not the "Money Bag" -- only the last bag thrown by each team member each round is the "Money Bag"</li>
<li>Whichever team won the previous round begins the next round. The two opponents will alternate throws.</li>
</ul>

<p><strong>Scoring</strong></p>
<ul>
<li>Only one team receives points each round.</li>
<li>A team receives:
  <ul>
    <li>1 point for landing the bag into the large bottom bucket.</li>
    <li>2 points for the middle tier bucket.</li>
    <li>3 points for the small top bucket.</li>
  </ul>
</li>
<li>The Money Bag is worth double points.</li>
<li>After adding each team's score, subtract the lesser score from the greater score to determine the total points for the team that scored more points.</li>
</ul>

<p><strong>Assisting ("Hacking")</strong></p>
<ul>
<li>Bags that fly over or to the side of the bucket may be hacked by a player on the same team into the buckets.</li>
<li>Hacking may be done with the <u>player's feet only</u>.</li>
<li><strong>Hacking assists may only occur behind or to the side of the bucket and <u>not over the top</u> of the bucket in back board fashion.</strong></li>
<li>If any part of the body touches the bucket during an assist, the bag thrown must be pulled if scored and NO points are awarded for that toss.</li>
</ul>

<p><strong>Notes</strong></p>
<ul>
<li>If a bag touches grass at any point, it is deemed dead and does not count even if it lands in a bucket.</li>
<li>When tossing a bag, the thrower's feet must be behind the bucket.</li>
<li>Rocks paper scissors shoot (first to win one) to see which team tosses the first bag.</li>
</ul>

<p><strong>20-Minute Rule:</strong> If neither team reaches 21 points at the end of 20 minutes, the team with the most points wins.</p>`,

            'Ladder Ball': `<h3>General</h3>
<ul>
<li>One game, winner take all.</li>
<li>First team to reach or exceed 21 points wins the game. Must win by 2 or more points.</li>
<li>Ladders are placed 15 feet apart.</li>
<li>One player from each team is on each side.</li>
<li>The goal of the game is to throw each bola at your opponent's ladder rungs and have them stick or wrap around the structure.</li>
<li>Each player throws all three of their bolas before another player can go.</li>
<li>Whichever team won the previous round begins the next round.</li>
</ul>

<p><strong>Scoring</strong></p>
<ul>
<li>Only one team receives points each round.</li>
<li>A team receives:
  <ul>
    <li>3 points for bola on the top rung.</li>
    <li>2 points for bola on the middle rung.</li>
    <li>1 point for bola on the bottom rung.</li>
  </ul>
</li>
<li>After adding each team's score, subtract the lesser score from the greater score to determine the total points for the team that scored more points.</li>
</ul>

<p><strong>Notes</strong></p>
<ul>
<li>Bolas must be thrown from behind the ladder.</li>
<li>Bolas can be tossed any way the player chooses (e.g. does not have to be underhand).</li>
<li>Each bola must be thrown separately.</li>
<li>Bolas that touch or bounce off the grass still count for points if they end up on a ladder rung.</li>
<li>If one bola is hanging from another bola, it counts for the same points as the bola it is hanging onto. For example, if one bola is hanging on the three point rung and another bola is hanging from this bola, then the other bola is also counted as hanging on the three point rung.</li>
<li>If a bola is knocked off a rung, it will not count toward the end-of-round score.</li>
<li>Rocks paper scissors shoot (first to win one) to see which team goes first.</li>
</ul>

<p><strong>20-Minute Rule:</strong> If neither team reaches 21 points at the end of 20 minutes, the team with the most points wins.</p>`,

            'Bean Bag Memory Match': `<div style="float: right; margin: 0 0 20px 20px; max-width: 250px;">
<img src="https://i.imgur.com/3W3kOMf.png" alt="Bean Bag Memory Match Setup" style="width: 100%; height: auto; border: 1px solid #ddd; border-radius: 8px;">
</div>

<h3>General</h3>
<ul>
<li>One game, winner take all.</li>
<li>First team to flip over every lid with a Match wins.</li>
<li>Both players are on the same side.</li>
<li>Each round consists of one person from each team throwing two bean bags.</li>
</ul>
<br>

<h3>Setup</h3>
<ul>
<li>At the beginning of the game, the lids are placed face down in the formation shown to the right. 4 lids are in the first row, 4 in the second row, and 4 in the third row. There are roughly 2 to 4 inches of space between each lid and 8 feet separate the front of the lid structures.</li>
<li>Lids are positioned randomly without looking at what picture is underneath.</li>
</ul>
<br>

<h3>Order of Play</h3>
<ul>
<li>The game begins with rocks paper scissors shoot (first to win one). The team that wins ("Team A") will toss first.</li>
<li>Standing behind their own lids, the first player from Team A tosses two bean bags at Team B's lids.</li>
<li>The first player from Team B tosses two bean bags at Team A's lids.</li>
<li>The second player from Team A tosses two bean bags at Team B's lids.</li>
<li>The second player from Team B tosses two bean bags at Team A's lids.</li>
<li>Play continues in this order until the end of the game.</li>
</ul>
<br>

<div style="clear: both;"></div>

<h3>Flipping Lids, Matches, and Mismatches</h3>
<ul>
<li>The first lid that the bean bag hits in the air is flipped upright, revealing the picture.</li>
<li>This lid remains upright until another lid is hit and flipped upright.</li>
<li>If the next lid hit and flipped upright matches the other flipped lid, this is a Match and the two lids remain upright for the remainder of the game.</li>
<li>If the next lid hit and flipped upright does not match the other flipped lid, this is a Mismatch and both lids are flipped back down revealing the pictures again. Remember what the pictures are!</li>
<li>If there is a lid flipped upright at the end of a turn (after two bean bag tosses), it remains upright for the next turn and until there is a Mismatch when both lids in the Mismatch are flipped back down.</li>
</ul>

<p><strong>Notes</strong></p>
<ul>
<li>If the bean bag hits the ground first, it is dead.</li>
<li>If the bean bag hits a lid and the ground simultaneously, it counts as a lid hit (not a dead bag).</li>
<li>If the bean bag hits a lid and then falls off and/or is touching the ground, it counts as a lid hit.</li>
<li>If the bean bag hits one lid and then ends up on another lid, the first lid is flipped (not the second).</li>
<li>If a bean bag hits two lids simultaneously, whichever lid it ends up on (or is covering more of) is the one considered hit.</li>
<li>If a bean bag hits a lid that is already upright, it is a dead bag (and the lid remains upright).</li>
<li>First team to flip all lids with Matches wins. There is no last chances or overtime.</li>
</ul>

<p><strong>20-Minute Rule:</strong> If neither team flips all lids by the 20 minute mark, whichever team has more Matches wins. If the teams are tied in Matches, then play continues until one team gets another Match.</p>`,

            'QB54': `<h3>General</h3>
<ul>
<li>One game, winner take all.</li>
<li>First team to reach or exceed 54 points wins the game (with the exception of a Hail Mary). Must win by 2 or more points.</li>
<li>Chairs are placed 30 feet apart.</li>
<li>Teammates play on the same side together.</li>
<li>Players alternate throws.</li>
</ul>
<br>

<h3>Order of Play</h3>
<ul>
<li>The game begins with rocks paper scissors shoot (first to win one). The team that wins will throw first.</li>
<li>Standing behind the chair, the player throws the football at the opposing chair.</li>
<li>Play alternates with each team throwing only once (both teammates do not throw the ball on each turn).</li>
</ul>
<br>

<h3>Scoring</h3>
<ul>
<li>3 points for Completion -- Hit <em>any part</em> of the chair/goalposts before the ball hits the ground.</li>
<li>6 points for Touchdown -- Throw the ball into the basket before the ball hits the ground.
  <ul>
    <li>Defense cannot try to knock the ball out of the basket</li>
  </ul>
</li>
<li>1 point for Extra Point after TD -- Kick the ball through the uprights. Ball is kicked at the midway point between the two chairs. The extra point is good if the ball is higher than the uprights but still through them.</li>
<li>2 points for Safety -- If the thrown ball bounces off the ground and into the basket, the defending team gets 2 points. The ball is dead and there is no safety if ball hits any part of the defending team's bodies.</li>
<li>3 points for Interception -- Defensive team catches a rebound off of the chair.
  <ul>
    <li>The ball must be in the air off of a bounce to be intercept -- it cannot be lifted off the chair</li>
  </ul>
</li>
<li>3 points for Defensive Interference -- Defensive team interferes with a ball that likely would have hit the chair before it makes contact with the chair</li>
<li>The Fitz -- If you kick the ball into the basket during an Extra Point after TD you win the game immediately.</li>
<li>First team to 54 points (by 2) wins.</li>
<li>Losing team gets one Hail Mary chance.
  <ul>
    <li>Subtract the winning score by the losing score to determine the steps (e.g. 54 points - 34 points = 20) (20 steps away from your goal).</li>
    <li>Take the number of steps (e.g. 20) with feet touching away from your chair. This is the place to throw the Hail Mary.</li>
    <li>If a touchdown is thrown from the Hail Mary pass you win. A miss and you lose.</li>
  </ul>
</li>
</ul>

<p><strong>Notes</strong></p>
<ul>
<li>Defensive team does not have to stand behind the chair -- players can stand on the side or even in front of (but not blocking) the chair.</li>
<li>Defensive players cannot touch the ball in midair if it has a reasonable chance of hitting the chair.</li>
<li>Teams switch sides when the leading team reaches 12, 24, 36, and 48 points.</li>
</ul>

<p><strong>20-Minute Rule:</strong> If neither team reaches 54 points at the end of 20 minutes, the team with the most points wins (pending Hail Mary). Losing team still gets their Hail Mary chance.</p>`,

            'Soccer Bocce': `<h3>General</h3>
<ul>
<li>One game, winner take all.</li>
<li>First team to 7 points wins the game.</li>
<li>Soccer Bocce is played with eight small soccer balls and one smaller target called a pallina.</li>
<li>There are four soccer balls per team and they are made of a different color (red and yellow) to distinguish the balls of one team from those of the other team.</li>
<li>Each player kicks two balls.</li>
</ul>
<br>

<h3>Order of Play</h3>
<ul>
<li>The game begins with rocks paper scissors shoot (first to win one). The team that wins can choose to either have the first toss of the pallina or the color of the balls they will use.</li>
<li>To start the game, the pallina is rolled or tossed roughly 20 to 40 feet (~10 to 20 steps). A marker is dropped where the pallina was tossed from. If the distance between the marker and pallina is significantly less than 20 feet or more than 40 feet, the pallina should be picked up and manually moved to an acceptable distance.</li>
<li>The player tossing the pallina must kick the first soccer ball. All balls are kicked from the marker.</li>
<li>The opposing team then kicks their balls until one of its soccer balls is closer to the pallina or has kicked all of its balls.</li>
<li>The "nearest ball" rule governs the sequence of kicked balls.
  <ul>
    <li>The side whose ball is closest to the pallina is called the "in" ball and the opposing side the "out" ball.</li>
    <li>Whenever a team gets "in", it steps aside and allows the "out" team to deliver.</li>
    <li>The other team kicks until it gets its ball closer to the pallina.</li>
    <li>This continues until both teams have kicked all their soccer balls.</li>
  </ul>
</li>
<li>After both teams have exhausted all their balls, a frame is over and points are awarded.</li>
<li>The team that was awarded points in the previous frame begins the next frame by tossing the pallina into play.</li>
</ul>
<br>

<h3>Scoring</h3>
<ul>
<li>At the end of each frame, points will be awarded.</li>
<li>Only one team scores in a frame. A team scores between 1 and 4 points per frame.</li>
<li>One point is awarded for each ball that is closer to the pallina than the closest ball of the opposing team.</li>
<li>In the event that the closest ball of each team is the same distance from the pallina, no points will be awarded and the pallina returns to the team that delivered it.</li>
<li>Only balls which are distinguishably closer to the pallina than any of the opponent's balls are awarded points.</li>
<li>All measurements should be made from the center of the pallina to the edge of a soccer ball.</li>
<li>If a soccer ball is touching the pallina, an extra point is awarded.</li>
</ul>

<p><strong>20-Minute Rule:</strong> If the allotted time expires, the team with the highest point total wins.</p>

<p><em>Please put the balls and pallina next to each other after you complete your game so the next teams can play.</em></p>`
        };
            'Mölkky': `<h3>General</h3>
<ul>
<li>One game, winner take all.</li>
<li>Game consists of twelve skittles (i.e. pins) numbered from 1 to 12 and one Mölkky throwing skittle.</li>
<li>Game is 2-on-2.</li>
<li>Object is to get exactly 50 points.</li>
<li>The Mölkky throwing skittle may be thrown any way, for example underhand, overhand, or sideways. It may also bounce on the grass.</li>
</ul>

<h3>Order of Play</h3>
<ul>
<li>The game begins with rocks paper scissors shoot (first to win one).</li>
<li>One of the teammates from the team that wins starts the game by tossing the Mölkky throwing skittle.</li>
<li>One of the teammates from the other team then tosses the Mölkky throwing skittle.</li>
<li>Teams and teammates continue rotating tosses for the rest of the game.</li>
</ul>

<h3>Setup</h3>
<ul>
<li>At the beginning of the game, the skittles are placed in a specific formation.</li>
<li>After a throw, fallen skittles are put upright at the place where they fell. As a result, the skittles are naturally spread out as the game progresses.</li>
<li>The throwing line is 10 feet from the front of the skittle formation. The Mölkky throwing skittle may be thrown from anywhere behind the throwing line, including from either side.</li>
</ul>

<h3>Scoring</h3>
<ul>
<li>If one skittle falls, the score is equal to the number on the pin. When more than one skittle falls, the score is equal to the number of fallen skittles.</li>
<li>A skittle is not considered fallen if it is leaning on another skittle or on the Mölkky throwing skittle.</li>
<li>The game ends when the first team reaches exactly 50 points.</li>
<li>If the team scores over 50, that team's score is lowered to 25.</li>
<li>If a team misses (has no score) three times in a row, that team's score is lowered to 0.</li>
</ul>

<p><strong>20-Minute Rule:</strong> If time expires and neither team has reached exactly 50 points, then the first team that exceeded 50 points wins. If neither team has exceeded 50 points, then whichever team has the most points wins.</p>

<p><em>Please reset the Molkky skittles after you complete your game so the next teams can play.</em></p>`,

            'Bocce': `<h3>General</h3>
<ul>
<li>One game, winner take all.</li>
<li>First team to 7 points wins the game.</li>
<li>Bocce is played with eight large balls and one smaller target ball called a pallina.</li>
<li>There are four balls per team and they are made of a different color to distinguish the balls of one team from those of the other team.</li>
<li>Each player throws two balls.</li>
</ul>

<h3>Order of Play</h3>
<ul>
<li>The game begins with rocks paper scissors shoot (first to win one). The team that wins can choose to either have the first toss of the pallina or the color of the balls they will use.</li>
<li>To start the game, the pallina is rolled or tossed roughly 20 to 40 feet (~10 to 20 steps). A marker is dropped where the pallina was tossed from.</li>
<li>The player tossing the pallina must deliver the first Bocce ball. All balls are tossed from the marker.</li>
<li>The opposing team then delivers their balls until one of its Bocce balls is closer to the pallina or has thrown all of its balls.</li>
<li>The "nearest ball" rule governs the sequence of thrown balls.</li>
<li>After both teams have exhausted all their balls, a frame is over and points are awarded.</li>
<li>The team that was awarded points in the previous frame begins the next frame by tossing the pallina into play.</li>
</ul>

<h3>Scoring</h3>
<ul>
<li>At the end of each frame, points will be awarded.</li>
<li>Only one team scores in a frame. A team scores between 1 and 4 points per frame.</li>
<li>One point is awarded for each ball that is closer to the pallina than the closest ball of the opposing team.</li>
<li>Only balls which are distinguishably closer to the pallina than any of the opponent's balls are awarded points.</li>
<li>All measurements should be made from the center of the pallina to the edge of a Bocce ball.</li>
<li>If a Bocce ball is touching the pallina, an extra point is awarded.</li>
</ul>

<p><strong>20-Minute Rule:</strong> If the allotted time expires, the team with the highest point total wins.</p>

<p><em>Please put the balls and pallina next to each other after you complete your game so the next teams can play.</em></p>`,

            'Giant Pong': `<h3>General</h3>
<ul>
<li>One game, winner take all.</li>
<li>Ten buckets are arranged in a triangle on each side of the court. The distance between the two front buckets shall be 15 feet. All buckets are partially filled with water.</li>
<li>Each team takes turns throwing two balls (one per teammate) into the other's buckets.</li>
<li>Once a ball lands in a bucket (aka "hits" the bucket), that bucket is taken away.</li>
<li>If both teammates hit buckets, the balls are returned and they get to shoot again.</li>
<li>The team that successfully hits all of the opponent's buckets first wins the game.</li>
<li>If the defending team catches or swats the ball before it hits the ground or a bucket, one bucket is removed of the throwing team's choice.</li>
<li>All throws must be taken from behind the bucket line (the line where the last row of buckets are set up).</li>
</ul>

<h3>First Throw</h3>
<ul>
<li>First throw is decided by "Eyes." A player from each team throws the ball while maintaining eye contact with their opponent throughout their toss.</li>
<li>If both players miss or both players make it, their partners now throw.</li>
<li>This goes on until one person makes it and their opponent does not.</li>
<li>The hit bucket is not removed.</li>
</ul>

<h3>Special Rules</h3>
<ul>
<li>Each team can twice request the buckets to be re-racked at the start of their turn.</li>
<li>If the ball hits off the ground and then goes into a bucket, the bucket that the ball goes into is removed, as well as another bucket of the defending player's choice. If there are only two buckets remaining, the bounce only counts as one cup.</li>
<li>If the ball gets wedged between multiple buckets, it counts as a miss (i.e. no buckets are removed).</li>
<li>If one bucket is hit and the teammate hits the same bucket before the first ball is pulled out, this is worth three cups (two additional chosen by the defending team).</li>
</ul>

<h3>Rebuttal & Overtime</h3>
<ul>
<li>After the last bucket is hit, each player from the losing team has a chance to hit the remaining buckets (aka rebuttal). Each player shoots until they miss.</li>
<li>If the players manage to hit all remaining buckets, the game goes into a three bucket overtime.</li>
<li>Three cups are placed back into a triangle shape. The would-have-been winners shoot first.</li>
<li>There are no re-racks permitted in overtime. Rebuttals are allowed in overtime.</li>
</ul>

<p><strong>20-Minute Rule:</strong> If the allotted time expires, the team with the fewest buckets remaining wins.</p>

<p><em>Please reset the buckets after you complete your game so the next teams can play.</em></p>`,

            'Cornhole': `<h3>General</h3>
<ul>
<li>One game, winner take all.</li>
<li>First team to reach or exceed 21 points wins the game.</li>
<li>Boards are placed 21 feet apart (front edge to front edge of each board).</li>
<li>One player from each team is on each side.</li>
<li>Round consists of one person from each team throwing four cornhole bags. The players will alternate tosses.</li>
<li>Whichever team had the last bag on the board or in the hole will then begin the next round. The two opponents will alternate throws.</li>
</ul>

<h3>Scoring</h3>
<ul>
<li>Only one team receives points each round.</li>
<li>A team receives 1 point for each bag on the board.</li>
<li>A team receives 3 points for each bag in the hole.</li>
<li>After adding each team's score, subtract the lesser score from the greater score to determine the total points for the team that scored more points.</li>
</ul>

<h3>Notes</h3>
<ul>
<li>If a bag touches grass at any point, it is deemed dead and does not count even if it lands on the board.</li>
<li>When tossing a bag, the thrower's feet must not cross the front edge of the board.</li>
<li>Rocks paper scissors shoot (first to win one) to see which team tosses the first bag.</li>
<li>Team does NOT have to win by two or more points. First team to 21 wins.</li>
</ul>

<p><strong>20-Minute Rule:</strong> If neither team reaches 21 points at the end of 20 minutes, the team with the most points wins.</p>`,

            'BULZiBUCKET': `<h3>General</h3>
<ul>
<li>One game, winner take all.</li>
<li>First team to reach or exceed 21 points wins the game. Must win by 2 or more points.</li>
<li>Buckets are placed 15 feet apart.</li>
<li>One player from each team is on each side.</li>
<li>Round consists of one person from each team throwing three bags. The players will alternate tosses.</li>
<li>The last bag thrown each round by each team member is known as the "Money Bag" and is worth double points.</li>
<li>Whichever team won the previous round begins the next round. The two opponents will alternate throws.</li>
</ul>

<h3>Scoring</h3>
<ul>
<li>Only one team receives points each round.</li>
<li>A team receives:
  <ul>
    <li>1 point for landing the bag into the large bottom bucket.</li>
    <li>2 points for the middle tier bucket.</li>
    <li>3 points for the small top bucket.</li>
  </ul>
</li>
<li>The Money Bag is worth double points.</li>
<li>After adding each team's score, subtract the lesser score from the greater score to determine the total points for the team that scored more points.</li>
</ul>

<h3>Assisting ("Hacking")</h3>
<ul>
<li>Bags that fly over or to the side of the bucket may be hacked by a player on the same team into the buckets.</li>
<li>Hacking may be done with the player's feet only.</li>
<li>Hacking assists may only occur behind or to the side of the bucket and NOT over the top of the bucket in back board fashion.</li>
<li>If any part of the body touches the bucket during an assist, the bag thrown must be pulled if scored and NO points are awarded for that toss.</li>
</ul>

<h3>Notes</h3>
<ul>
<li>If a bag touches grass at any point, it is deemed dead and does not count even if it lands in a bucket.</li>
<li>When tossing a bag, the thrower's feet must be behind the bucket.</li>
<li>Rocks paper scissors shoot (first to win one) to see which team tosses the first bag.</li>
</ul>

<p><strong>20-Minute Rule:</strong> If neither team reaches 21 points at the end of 20 minutes, the team with the most points wins.</p>`,

            'Ladder Ball': `<h3>General</h3>
<ul>
<li>One game, winner take all.</li>
<li>First team to reach or exceed 21 points wins the game. Must win by 2 or more points.</li>
<li>Ladders are placed 15 feet apart.</li>
<li>One player from each team is on each side.</li>
<li>The goal of the game is to throw each bola at your opponent's ladder rungs and have them stick or wrap around the structure.</li>
<li>Each player throws all three of their bolas before another player can go.</li>
<li>Whichever team won the previous round begins the next round.</li>
</ul>

<h3>Scoring</h3>
<ul>
<li>Only one team receives points each round.</li>
<li>A team receives:
  <ul>
    <li>3 points for bola on the top rung.</li>
    <li>2 points for bola on the middle rung.</li>
    <li>1 point for bola on the bottom rung.</li>
  </ul>
</li>
<li>After adding each team's score, subtract the lesser score from the greater score to determine the total points for the team that scored more points.</li>
</ul>

<h3>Notes</h3>
<ul>
<li>Bolas must be thrown from behind the ladder.</li>
<li>Bolas can be tossed any way the player chooses (e.g. does not have to be underhand).</li>
<li>Each bola must be thrown separately.</li>
<li>Bolas that touch or bounce off the grass still count for points if they end up on a ladder rung.</li>
<li>If one bola is hanging from another bola, it counts for the same points as the bola it is hanging onto.</li>
<li>If a bola is knocked off a rung, it will not count toward the end-of-round score.</li>
<li>Rocks paper scissors shoot (first to win one) to see which team goes first.</li>
</ul>

<p><strong>20-Minute Rule:</strong> If neither team reaches 21 points at the end of 20 minutes, the team with the most points wins.</p>`,

            'Bean Bag Memory Match': `<h3>General</h3>
<ul>
<li>One game, winner take all.</li>
<li>First team to flip over every lid with a Match wins.</li>
<li>Both players are on the same side.</li>
<li>Each round consists of one person from each team throwing two bean bags.</li>
</ul>

<h3>Setup</h3>
<ul>
<li>At the beginning of the game, the lids are placed face down in a formation. 4 lids are in the first row, 4 in the second row, and 4 in the third row. There are roughly 2 to 4 inches of space between each lid and 8 feet separate the front of the lid structures.</li>
<li>Lids are positioned randomly without looking at what picture is underneath.</li>
</ul>

<h3>Order of Play</h3>
<ul>
<li>The game begins with rocks paper scissors shoot (first to win one). The team that wins ("Team A") will toss first.</li>
<li>Standing behind their own lids, the first player from Team A tosses two bean bags at Team B's lids.</li>
<li>The first player from Team B tosses two bean bags at Team A's lids.</li>
<li>The second player from Team A tosses two bean bags at Team B's lids.</li>
<li>The second player from Team B tosses two bean bags at Team A's lids.</li>
<li>Play continues in this order until the end of the game.</li>
</ul>

<h3>Flipping Lids, Matches, and Mismatches</h3>
<ul>
<li>The first lid that the bean bag hits in the air is flipped upright, revealing the picture.</li>
<li>This lid remains upright until another lid is hit and flipped upright.</li>
<li>If the next lid hit and flipped upright matches the other flipped lid, this is a Match and the two lids remain upright for the remainder of the game.</li>
<li>If the next lid hit and flipped upright does not match the other flipped lid, this is a Mismatch and both lids are flipped back down revealing the pictures again. Remember what the pictures are!</li>
<li>If there is a lid flipped upright at the end of a turn (after two bean bag tosses), it remains upright for the next turn.</li>
</ul>

<h3>Notes</h3>
<ul>
<li>If the bean bag hits the ground first, it is dead.</li>
<li>If the bean bag hits a lid and the ground simultaneously, it counts as a lid hit (not a dead bag).</li>
<li>If the bean bag hits a lid and then falls off and/or is touching the ground, it counts as a lid hit.</li>
<li>If the bean bag hits one lid and then ends up on another lid, the first lid is flipped (not the second).</li>
<li>If a bean bag hits two lids simultaneously, whichever lid it ends up on (or is covering more of) is the one considered hit.</li>
<li>If a bean bag hits a lid that is already upright, it is a dead bag (and the lid remains upright).</li>
<li>First team to flip all lids with Matches wins. There is no last chances or overtime.</li>
</ul>

<p><strong>20-Minute Rule:</strong> If neither team flips all lids by the 20 minute mark, whichever team has more Matches wins. If the teams are tied in Matches, then play continues until one team gets another Match.</p>`,

            'QB54': `<h3>General</h3>
<ul>
<li>One game, winner take all.</li>
<li>First team to reach or exceed 54 points wins the game (with the exception of a Hail Mary). Must win by 2 or more points.</li>
<li>Chairs are placed 30 feet apart.</li>
<li>Teammates play on the same side together.</li>
<li>Players alternate throws.</li>
</ul>

<h3>Order of Play</h3>
<ul>
<li>The game begins with rocks paper scissors shoot (first to win one). The team that wins will throw first.</li>
<li>Standing behind the chair, the player throws the football at the opposing chair.</li>
<li>Play alternates with each team throwing only once (both teammates do not throw the ball on each turn).</li>
</ul>

<h3>Scoring</h3>
<ul>
<li>3 points for Completion -- Hit any part of the chair/goalposts before the ball hits the ground.</li>
<li>6 points for Touchdown -- Throw the ball into the basket before the ball hits the ground. Defense cannot try to knock the ball out of the basket.</li>
<li>1 point for Extra Point after TD -- Kick the ball through the uprights. Ball is kicked at the midway point between the two chairs.</li>
<li>2 points for Safety -- If the thrown ball bounces off the ground and into the basket, the defending team gets 2 points.</li>
<li>3 points for Interception -- Defensive team catches a rebound off of the chair. The ball must be in the air off of a bounce to be intercept.</li>
<li>3 points for Defensive Interference -- Defensive team interferes with a ball that likely would have hit the chair before it makes contact with the chair.</li>
<li>The Fitz -- If you kick the ball into the basket during an Extra Point after TD you win the game immediately.</li>
<li>First team to 54 points (by 2) wins.</li>
</ul>

<h3>Hail Mary</h3>
<ul>
<li>Losing team gets one Hail Mary chance.</li>
<li>Subtract the winning score by the losing score to determine the steps (e.g. 54 points - 34 points = 20).</li>
<li>Take the number of steps with feet touching away from your chair. This is the place to throw the Hail Mary.</li>
<li>If a touchdown is thrown from the Hail Mary pass you win. A miss and you lose.</li>
</ul>

<h3>Notes</h3>
<ul>
<li>Defensive team does not have to stand behind the chair -- players can stand on the side or even in front of (but not blocking) the chair.</li>
<li>Defensive players cannot touch the ball in midair if it has a reasonable chance of hitting the chair.</li>
<li>Teams switch sides when the leading team reaches 12, 24, 36, and 48 points.</li>
</ul>

<p><strong>20-Minute Rule:</strong> If neither team reaches 54 points at the end of 20 minutes, the team with the most points wins (pending Hail Mary). Losing team still gets their Hail Mary chance.</p>`,

            'Soccer Bocce': `<h3>General</h3>
<ul>
<li>One game, winner take all.</li>
<li>First team to 7 points wins the game.</li>
<li>Soccer Bocce is played with eight small soccer balls and one smaller target called a pallina.</li>
<li>There are four soccer balls per team and they are made of a different color (red and yellow) to distinguish the balls of one team from those of the other team.</li>
<li>Each player kicks two balls.</li>
</ul>

<h3>Order of Play</h3>
<ul>
<li>The game begins with rocks paper scissors shoot (first to win one). The team that wins can choose to either have the first toss of the pallina or the color of the balls they will use.</li>
<li>To start the game, the pallina is rolled or tossed roughly 20 to 40 feet (~10 to 20 steps). A marker is dropped where the pallina was tossed from.</li>
<li>The player tossing the pallina must kick the first soccer ball. All balls are kicked from the marker.</li>
<li>The opposing team then kicks their balls until one of its soccer balls is closer to the pallina or has kicked all of its balls.</li>
<li>The "nearest ball" rule governs the sequence of kicked balls.</li>
<li>After both teams have exhausted all their balls, a frame is over and points are awarded.</li>
<li>The team that was awarded points in the previous frame begins the next frame by tossing the pallina into play.</li>
</ul>

<h3>Scoring</h3>
<ul>
<li>At the end of each frame, points will be awarded.</li>
<li>Only one team scores in a frame. A team scores between 1 and 4 points per frame.</li>
<li>One point is awarded for each ball that is closer to the pallina than the closest ball of the opposing team.</li>
<li>Only balls which are distinguishably closer to the pallina than any of the opponent's balls are awarded points.</li>
<li>All measurements should be made from the center of the pallina to the edge of a soccer ball.</li>
<li>If a soccer ball is touching the pallina, an extra point is awarded.</li>
</ul>

<p><strong>20-Minute Rule:</strong> If the allotted time expires, the team with the highest point total wins.</p>

<p><em>Please put the balls and pallina next to each other after you complete your game so the next teams can play.</em></p>`
        };
        
        const OVERVIEW_TEXT = `<h3>General</h3>
<ul>
<li>Teams of two players compete in 9 events against random different teams for each event.
  <ul>
    <li>Teams may compete against each other twice in different events</li>
  </ul>
</li>
<li>Each event lasts strictly 20 minutes.</li>
<li>After completing your event, please reset it for the next teams that play.</li>
</ul>
<br>

<h3>Events</h3>
<ul>
<li>Mölkky</li>
<li>Bocce</li>
<li>Giant Pong</li>
<li>Cornhole</li>
<li>BULZiBUCKET</li>
<li>Ladder Ball</li>
<li>QB54</li>
<li>Soccer Bocce</li>
<li>Bean Bag Memory Match</li>
</ul>

<h3>Playoffs</h3>
<ul>
<li>The top 10 teams advance to the playoffs.
  <ul>
    <li>Tiebreakers are solved with the "point wagering" system designed at the outset.</li>
    <li>Higher Seed goes first to start off each game.</li>
  </ul>
</li>
<li><strong>Wild Card Round</strong>
  <ul>
    <li>The top 6 seeds get a bye and do not participate in the Wild Card Round.</li>
    <li>7<sup>th</sup> seed plays 10<sup>th</sup> seed and 8<sup>th</sup> seed plays 9<sup>th</sup> seed.</li>
    <li>Each team plays Giant Pong with only 3 buckets (vs the usual 10) in a fast-paced single elimination playoff. There is no overtime.</li>
    <li>Both games are played simultaneously.</li>
  </ul>
</li>
<li><strong>Remaining Playoff Rounds</strong>
  <ul>
    <li>1 vs. 8, 2 vs. 7, 3 vs. 6, 4 vs. 5 in the next round.</li>
    <li>All rules remain the same for each game except for the Wild Card Round.</li>
    <li>In subsequent rounds, the highest remaining seed will play the lowest remaining seed, etc.</li>
  </ul>
</li>
<li><strong>Choice of Games</strong>
  <ul>
    <li>For each game in the playoffs, the highest seed team will pick a game out of a hat.</li>
    <li>Once the game is picked, the higher seed has the choice to play that game or redraw among the remaining events. Only one redraw (veto) is allowed.</li>
    <li>Once two teams are given a game to play, the next highest seed picks one of the remaining games out of a hat.</li>
  </ul>
</li>
<li><strong>The Finals</strong> will be a combination of 3 events, "best of" style.
  <ul>
    <li>Top seed picks first and third events (game of team's choice, <em>not out of the hat</em>). Second team picks second event. All events are picked before the first event is played.</li>
    <li>Each team can veto TWO selections by the other team (e.g. a team may say the other team cannot choose Giant Pong or Cornhole). Vetos by each team are declared <em>before</em> the teams announce their selections.</li>
  </ul>
</li>
<li>In the event of a TIE for playoff seeding (same record and same point total based on their wagers):
  <ul>
    <li>1<sup>st</sup> tiebreaker: head-to-head record -- if one has beaten the other, that team is the higher seed.</li>
    <li>If teams did not play each other, then rocks paper scissors shoot will decide order (first to win 1).
      <ul>
        <li>If two teams meet in the playoffs with same point total and seeding determined by rocks paper scissors, the game will be pulled from the hat with no option to veto.</li>
      </ul>
    </li>
  </ul>
</li>
</ul>`;

        async function loadData() {
            if (BACKEND_URL === 'YOUR_SCRIPT_URL_HERE') {
                state.connectionStatus = 'error';
                console.error('Please set your Google Apps Script URL!');
                return;
            }
            
            // Don't load if we saved in the last 5 seconds - prevents overwriting local changes
            const timeSinceLastSave = Date.now() - lastSaveTime;
            if (timeSinceLastSave < 5000) {
                console.log(`Skipping load - saved ${Math.round(timeSinceLastSave/1000)}s ago`);
                return;
            }
            
            try {
                state.connectionStatus = 'loading';
                
                const response = await fetch(BACKEND_URL);
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const serverData = await response.json();
                console.log('Raw server response:', serverData);
                console.log('teamNames from server:', serverData.teamNames);
                console.log('wagers from server:', serverData.wagers);
                console.log('results from server:', serverData.results);
                
                if (serverData.teamNames) {
                    try {
                        const parsed = JSON.parse(serverData.teamNames);
                        console.log('Parsed teamNames:', parsed);
                        data.teamNames = parsed;
                    } catch (e) {
                        console.error('Error parsing teamNames:', e);
                        data.teamNames = {};
                    }
                }
                if (serverData.wagers) {
                    try {
                        const parsed = JSON.parse(serverData.wagers);
                        console.log('Parsed wagers:', parsed);
                        data.wagers = parsed;
                    } catch (e) {
                        console.error('Error parsing wagers:', e);
                        data.wagers = {};
                    }
                }
                if (serverData.results) {
                    try {
                        const parsed = JSON.parse(serverData.results);
                        console.log('Parsed results:', parsed);
                        data.results = parsed;
                    } catch (e) {
                        console.error('Error parsing results:', e);
                        data.results = {};
                    }
                }
                
                state.connectionStatus = 'connected';
                render();
            } catch (e) {
                console.error('Error loading data:', e);
                state.connectionStatus = 'error';
            }
        }

        async function saveData() {
            if (BACKEND_URL === 'YOUR_SCRIPT_URL_HERE') {
                console.error('Please set your Google Apps Script URL!');
                return;
            }
            
            console.log('saveData starting');
            
            try {
                state.connectionStatus = 'loading';
                
                const payload = {
                    teamNames: JSON.stringify(data.teamNames),
                    wagers: JSON.stringify(data.wagers),
                    results: JSON.stringify(data.results)
                };
                
                console.log('Saving to server:', payload);
                
                // Use URL parameters instead of POST body to avoid CORS issues
                const params = new URLSearchParams({
                    action: 'save',
                    data: JSON.stringify(payload)
                });
                
                const response = await fetch(`${BACKEND_URL}?${params.toString()}`);
                
                console.log('Save response status:', response.status);
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const result = await response.json();
                console.log('Save response:', result);
                
                if (result.error) {
                    throw new Error(result.error);
                }
                
                console.log('Saved data successfully');
                state.connectionStatus = 'connected';
                
            } catch (e) {
                console.error('Error saving data:', e);
                state.connectionStatus = 'error';
            } finally {
                isSaving = false;
            }
        }

        function getTeamName(num) {
            return data.teamNames[num] || `Team ${num}`;
        }

        function getResultKey(time, t1, t2, event) {
            return `${time}_${t1}_${t2}_${event}`;
        }

        function getResult(time, t1, t2, event) {
            return data.results[getResultKey(time, t1, t2, event)];
        }

        function saveResult(time, t1, t2, event, winner) {
            console.log('Button clicked - starting saveResult');
            const key = getResultKey(time, t1, t2, event);
            // If clicking the same result again, undo it
            if (data.results[key] === winner) {
                delete data.results[key];
            } else {
                data.results[key] = winner;
            }
            
            // Record save time to block auto-refresh
            lastSaveTime = Date.now();
            
            render(); // Update UI immediately
            saveData(); // Save in background (no await)
        }

        function getTeamSchedule(teamNum) {
            const schedule = [];
            SCHEDULE.forEach(slot => {
                if (slot.matches[0][2] === 'Pizza!') {
                    schedule.push({ time: slot.time, event: 'Pizza!', opponent: null });
                    return;
                }
                slot.matches.forEach(m => {
                    if (m[0] === teamNum) {
                        schedule.push({ time: slot.time, event: m[2], opponent: m[1], team1: m[0], team2: m[1] });
                    } else if (m[1] === teamNum) {
                        schedule.push({ time: slot.time, event: m[2], opponent: m[0], team1: m[0], team2: m[1] });
                    }
                });
            });
            return schedule;
        }

        function calculateStandings() {
            const standings = [];
            for (let i = 1; i <= 20; i++) {
                let wins = 0, losses = 0, wagerPoints = 0;
                const teamWagers = data.wagers[i] || {};
                SCHEDULE.forEach(slot => {
                    if (slot.matches[0][2] === 'Pizza!') return;
                    slot.matches.forEach(m => {
                        if (m[2] === 'Break') return;
                        const result = getResult(slot.time, m[0], m[1], m[2]);
                        if (m[0] === i && result !== undefined) {
                            if (result === m[0]) {
                                wins++;
                                wagerPoints += teamWagers[m[2]] || 0;
                            } else losses++;
                        } else if (m[1] === i && result !== undefined) {
                            if (result === m[1]) {
                                wins++;
                                wagerPoints += teamWagers[m[2]] || 0;
                            } else losses++;
                        }
                    });
                });
                standings.push({ team: i, name: getTeamName(i), wins, losses, wagerPoints });
            }
            standings.sort((a, b) => b.wins !== a.wins ? b.wins - a.wins : b.wagerPoints - a.wagerPoints);
            return standings;
        }

        function render() {
            console.time('render');
            
            // Save scroll position before rendering
            const scrollPos = window.pageYOffset || document.documentElement.scrollTop;
            
            const app = document.getElementById('app');
            if (state.view === 'team-select') {
                app.innerHTML = `
                    <h1 class="title">🏆 10th Annual Silvalympics</h1>
                    <div class="team-grid">
                        ${[...Array(20)].map((_, i) => `
                            <button class="team-btn" onclick="selectTeam(${i+1})">
                                <div class="team-num">Team ${i+1}</div>
                                <div class="team-name">${getTeamName(i+1)}</div>
                            </button>
                        `).join('')}
                    </div>
                    <button class="clear-data-btn" onclick="clearAllData()">Clear Data</button>
                `;
            } else if (state.view === 'menu') {
                const scheduleBtn = schedulesEnabled 
                    ? '<button class="menu-btn purple" onclick="state.view=\'schedule\'; render()">📅 View Schedule</button>'
                    : '<button class="menu-btn purple disabled" style="pointer-events: none;">📅 View Schedule</button>';
                
                app.innerHTML = `
                    <button class="back-btn" onclick="state.view='team-select'; render()">← Back to Team Selection</button>
                    <div class="card">
                        <h2 class="card-title">${getTeamName(state.selectedTeam)}</h2>
                        <button class="menu-btn blue" onclick="state.view='team-names'; render()">👥 Enter Team Names</button>
                        <button class="menu-btn green" onclick="state.view='wagers'; render()">🎯 Set Wagers</button>
                        ${scheduleBtn}
                        <button class="menu-btn orange" onclick="state.view='results'; render()">🏆 Enter Results</button>
                        <button class="menu-btn red" onclick="state.view='standings'; render()">📊 View Standings</button>
                        <button class="menu-btn blue" onclick="state.view='overview'; render()" style="background: #6366f1;">📋 Silvalympics Overview</button>
                    </div>
                `;
            } else if (state.view === 'team-names') {
                app.innerHTML = `
                    <button class="back-btn" onclick="state.view='menu'; render()">← Back to Menu</button>
                    <div class="card">
                        <h2 class="card-title">Team ${state.selectedTeam} Names</h2>
                        <div class="input-group">
                            <label>Player 1</label>
                            <input type="text" id="name1" placeholder="Enter name">
                        </div>
                        <div class="input-group">
                            <label>Player 2</label>
                            <input type="text" id="name2" placeholder="Enter name">
                        </div>
                        <button class="menu-btn purple" onclick="saveTeamNames()">Save Names</button>
                    </div>
                `;
            } else if (state.view === 'wagers') {
                const teamWagers = data.wagers[state.selectedTeam] || {};
                const total = Object.values(teamWagers).reduce((sum, val) => sum + (parseInt(val) || 0), 0);
                const totalClass = total === 50 ? 'valid' : 'invalid';
                app.innerHTML = `
                    <button class="back-btn" onclick="state.view='menu'; render()">← Back to Menu</button>
                    <div class="card">
                        <h2 class="card-title">Set Wagers</h2>
                        <p style="text-align:center; color:#666; margin-bottom:15px;">Each wager: 1-20 | Total must equal 50</p>
                        <div class="total ${totalClass}">Total: ${total} / 50</div>
                        <button class="menu-btn" onclick="randomizeWagers()" style="background: #8b5cf6; margin-bottom: 15px;">
                            🎲 Randomize Wagers
                        </button>
                        <div class="scrollable">
                            ${EVENTS.map(event => `
                                <div class="wager-row">
                                    <label>${event}</label>
                                    <input type="number" min="1" max="20" value="${teamWagers[event] || ''}" 
                                        onchange="updateWager('${event}', this.value)">
                                </div>
                            `).join('')}
                        </div>
                        <button class="menu-btn purple ${state.wagersSaved ? 'saved' : ''}" 
                            onclick="saveWagers()">${state.wagersSaved ? '✓ Wagers Saved!' : 'Save Wagers'}</button>
                    </div>
                `;
            } else if (state.view === 'schedule') {
                const schedule = getTeamSchedule(state.selectedTeam);
                app.innerHTML = `
                    <button class="back-btn" onclick="state.view='menu'; render()">← Back to Menu</button>
                    <div class="card">
                        <h2 class="card-title">${getTeamName(state.selectedTeam)} Schedule</h2>
                        <div class="scrollable">
                            ${schedule.map(item => `
                                <div class="schedule-item">
                                    <div class="schedule-time">${item.time}</div>
                                    <div class="schedule-event" style="${item.event !== 'Break' && item.event !== 'Pizza!' ? 'cursor: pointer; text-decoration: underline;' : ''}" 
                                        ${item.event !== 'Break' && item.event !== 'Pizza!' ? `onclick="showRules('${item.event}')"` : ''}>
                                        ${item.event}
                                    </div>
                                    ${item.opponent && item.event !== 'Break' ? `<div class="schedule-vs">vs ${getTeamName(item.opponent)}</div>` : ''}
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;
            } else if (state.view === 'results') {
                const schedule = getTeamSchedule(state.selectedTeam);
                app.innerHTML = `
                    <button class="back-btn" onclick="state.view='menu'; render()">← Back to Menu</button>
                    <div class="card">
                        <h2 class="card-title">Enter Results</h2>
                        <div class="scrollable">
                            ${schedule.map(item => {
                                if (!item.opponent || item.event === 'Break' || item.event === 'Pizza!') return '';
                                const result = getResult(item.time, item.team1, item.team2, item.event);
                                const didWin = result === state.selectedTeam;
                                const didLose = result !== undefined && result !== state.selectedTeam;
                                return `
                                    <div class="schedule-item">
                                        <div class="schedule-time">${item.time} - ${item.event}</div>
                                        <div class="schedule-vs">vs ${getTeamName(item.opponent)}</div>
                                        <div class="result-btns">
                                            <button class="win-btn ${didWin ? 'active' : ''}" 
                                                onclick="saveResult('${item.time}', ${item.team1}, ${item.team2}, '${item.event}', ${state.selectedTeam})">Win</button>
                                            <button class="lose-btn ${didLose ? 'active' : ''}" 
                                                onclick="saveResult('${item.time}', ${item.team1}, ${item.team2}, '${item.event}', ${item.opponent})">Lose</button>
                                        </div>
                                    </div>
                                `;
                            }).join('')}
                        </div>
                    </div>
                `;
            } else if (state.view === 'standings') {
                const standings = calculateStandings();
                app.innerHTML = `
                    <button class="back-btn" onclick="state.view='menu'; render()">← Back to Menu</button>
                    <div class="card">
                        <h2 class="card-title">Live Standings</h2>
                        <div class="scrollable">
                            ${standings.map((team, idx) => {
                                let bgClass = 'standing-red', badgeClass = '', badgeText = '';
                                if (idx < 6) {
                                    bgClass = 'standing-green';
                                    badgeClass = 'badge-green';
                                    badgeText = '🏆 BYE';
                                } else if (idx < 10) {
                                    bgClass = 'standing-blue';
                                    badgeClass = 'badge-blue';
                                    badgeText = '🎯 PLAYOFF';
                                }
                                return `
                                    <div class="standing ${bgClass}">
                                        <div class="standing-left">
                                            <div class="standing-rank">${idx + 1}</div>
                                            <div>
                                                <div class="standing-name">${team.name}</div>
                                                <div class="standing-record">${team.wins}-${team.losses} (${team.wagerPoints} pts)</div>
                                            </div>
                                        </div>
                                        ${badgeText ? `<div class="standing-badge ${badgeClass}">${badgeText}</div>` : ''}
                                    </div>
                                `;
                            }).join('')}
                        </div>
                        <div class="info-box">
                            <div><strong>Playoff Format:</strong></div>
                            <div>🟢 Top 6: First Round BYE</div>
                            <div>🔵 Seeds 7-10: Wild Card Round</div>
                            <div>🔴 Seeds 11-20: Eliminated</div>
                        </div>
                    </div>
                `;
            } else if (state.view === 'rules') {
                const backView = state.returnTo || 'schedule';
                app.innerHTML = `
                    <button class="back-btn" onclick="state.view='${backView}'; render()">← Back to ${backView === 'overview' ? 'Overview' : 'Schedule'}</button>
                    <div class="card">
                        <h2 class="card-title">${state.currentEvent} Rules</h2>
                        <div class="scrollable" style="text-align: left;">
                            ${EVENT_RULES[state.currentEvent] || '<p>Rules not available</p>'}
                        </div>
                    </div>
                `;
            } else if (state.view === 'overview') {
                app.innerHTML = `
                    <button class="back-btn" onclick="state.view='menu'; render()">← Back to Menu</button>
                    <div class="card">
                        <h2 class="card-title">Silvalympics Overview</h2>
                        <div class="scrollable" style="text-align: left;">
                            ${OVERVIEW_TEXT.replace(/<li>(Mölkky|Bocce|Giant Pong|Cornhole|BULZiBUCKET|Ladder Ball|QB54|Soccer Bocce|Bean Bag Memory Match)<\/li>/g, 
                                '<li><span style="color: #8b5cf6; cursor: pointer; text-decoration: underline;" onclick="showRules(\'$1\')">$1</span></li>')}
                        </div>
                    </div>
                `;
            }
            console.timeEnd('render');
            
            // Restore scroll position after rendering
            window.scrollTo(0, scrollPos);
        }

        function selectTeam(num) {
            state.selectedTeam = num;
            state.view = 'menu';
            render();
        }
        
        function showRules(eventName) {
            state.returnTo = state.view; // Save current view before switching
            state.view = 'rules';
            state.currentEvent = eventName;
            render();
        }

        function saveTeamNames() {
            const name1 = document.getElementById('name1').value;
            const name2 = document.getElementById('name2').value;
            if (name1 && name2) {
                data.teamNames[state.selectedTeam] = `${name1} & ${name2}`;
                state.view = 'menu';
                lastSaveTime = Date.now(); // Block auto-refresh
                render(); // Update UI immediately
                saveData(); // Save in background (no await)
            }
        }

        function updateWager(event, value) {
            const val = parseInt(value) || 0;
            if (val >= 1 && val <= 20) {
                if (!data.wagers[state.selectedTeam]) data.wagers[state.selectedTeam] = {};
                data.wagers[state.selectedTeam][event] = val;
                render();
            }
        }

        function saveWagers() {
            const teamWagers = data.wagers[state.selectedTeam] || {};
            const total = Object.values(teamWagers).reduce((sum, val) => sum + val, 0);
            if (total !== 50) {
                alert('Wagers must total 50!');
                return;
            }
            lastSaveTime = Date.now(); // Block auto-refresh
            state.wagersSaved = true;
            render(); // Update UI immediately
            saveData(); // Save in background (no await)
            setTimeout(() => {
                state.wagersSaved = false;
                render();
            }, 2000);
        }

        async function clearAllData() {
            const code = prompt('Enter 4-digit code to clear all data:');
            if (code === '0820') {
                if (confirm('Are you SURE you want to clear ALL data? This cannot be undone!')) {
                    data.teamNames = {};
                    data.wagers = {};
                    data.results = {};
                    lastSaveTime = Date.now();
                    await saveData();
                    alert('All data cleared!');
                    state.view = 'team-select';
                    render();
                }
            } else if (code !== null) {
                alert('Incorrect code!');
            }
        }
        
        function toggleSchedules() {
            const code = prompt('Enter 4-digit code to toggle schedules:');
            if (code === '0820') {
                schedulesEnabled = !schedulesEnabled;
                alert(schedulesEnabled ? 'Schedules enabled!' : 'Schedules disabled!');
                render();
            } else if (code !== null) {
                alert('Incorrect code!');
            }
        }
        
        function randomizeWagers() {
            const wagerData = {};
            let remaining = 50;
            const events = [...EVENTS];
            
            // Assign random wagers between 1-20 for first 8 events
            for (let i = 0; i < 8; i++) {
                const min = Math.max(1, remaining - (20 * (8 - i)));
                const max = Math.min(20, remaining - (8 - i));
                const wager = Math.floor(Math.random() * (max - min + 1)) + min;
                wagerData[events[i]] = wager;
                remaining -= wager;
            }
            
            // Last event gets whatever is remaining
            wagerData[events[8]] = remaining;
            
            if (!data.wagers[state.selectedTeam]) data.wagers[state.selectedTeam] = {};
            data.wagers[state.selectedTeam] = wagerData;
            render();
        }

        (async () => {
            await loadData();
            setInterval(async () => {
                // Only auto-refresh on certain screens to avoid clearing inputs
                if (state.view === 'team-select' || state.view === 'menu' || state.view === 'schedule' || state.view === 'results' || state.view === 'standings') {
                    await loadData();
                }
            }, 10000); // Changed from 3000ms to 10000ms (10 seconds)
        })();
    </script>
</body>
</html>
